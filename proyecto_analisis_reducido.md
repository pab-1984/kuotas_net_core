# Estructura del Proyecto

```text
/Users/pabloflores/Desktop/migracion-net-core/Kuotasmig.Core
(0tqq (BData
(0x   mqq (BBDService.cs
(0tqq (BKuotasmig.Core.csproj
(0tqq (BModels
(0x   tqq (BCalculadoraEntry.cs
(0x   tqq (BFilaAmortizacion.cs
(0x   mqq (BUsuario.cs
(0tqq (BPages
(0x   tqq (BCalculoDeInteresCompuesto.cshtml
(0x   tqq (BCalculoDeInteresCompuesto.cshtml.cs
(0x   tqq (BCalculoDeInteresSimple.cshtml
(0x   tqq (BCalculoDeInteresSimple.cshtml.cs
(0x   tqq (BDefault.cshtml
(0x   tqq (BDefault.cshtml.cs
(0x   tqq (BDiasTranscurridos360.cshtml
(0x   tqq (BDiasTranscurridos360.cshtml.cs
(0x   tqq (BError.cshtml
(0x   tqq (BError.cshtml.cs
(0x   tqq (BIndex.cshtml
(0x   tqq (BIndex.cshtml.cs
(0x   tqq (BLogin.cshtml
(0x   tqq (BLogin.cshtml.cs
(0x   tqq (BPlanillaDeAmortizacion.cshtml
(0x   tqq (BPlanillaDeAmortizacion.cshtml.cs
(0x   tqq (BPrivacy.cshtml
(0x   tqq (BPrivacy.cshtml.cs
(0x   tqq (BRendimientoAnualReal.cshtml
(0x   tqq (BRendimientoAnualReal.cshtml.cs
(0x   tqq (BShared
(0x   x   tqq (B_Layout.cshtml
(0x   x   tqq (B_Layout.cshtml.css
(0x   x   mqq (B_ValidationScriptsPartial.cshtml
(0x   tqq (BSumarDiasACiertaFecha.cshtml
(0x   tqq (BSumarDiasACiertaFecha.cshtml.cs
(0x   tqq (B_ViewImports.cshtml
(0x   mqq (B_ViewStart.cshtml
(0tqq (BProgram.cs
(0tqq (BProperties
(0x   mqq (BlaunchSettings.json
(0tqq (BServices
(0x   tqq (BCalculadoraService.cs
(0x   tqq (BCalculoAmortizacionService.cs
(0x   mqq (BUsuarioService.cs
(0tqq (Bappsettings.Development.json
(0tqq (Bappsettings.json
(0tqq (Bfind_live_errors.txt
(0tqq (Blibman.json
(0mqq (Bwwwroot
(0    tqq (Bcss
(0    x   tqq (Banimate.css
(0    x   tqq (Bbootstrap.css
(0    x   tqq (Bbootstrap.min.css
(0    x   tqq (Bclndr.css
(0    x   tqq (Bcustom.css
(0    x   tqq (Bfont-awesome.css
(0    x   tqq (Bjqvmap.css
(0    x   tqq (Blines.css
(0    x   tqq (Bsite.css
(0    x   tqq (Bstyle.css
(0    x   mqq (Bstyle2.css
(0    tqq (Bfavicon.ico
(0    tqq (Bfonts
(0    x   tqq (BFontAwesome.otf
(0    x   tqq (Bfontawesome-webfont.eot
(0    x   tqq (Bfontawesome-webfont.svg
(0    x   tqq (Bfontawesome-webfont.ttf
(0    x   tqq (Bfontawesome-webfont.woff
(0    x   tqq (Bfontawesome-webfont.woff2
(0    x   tqq (Bglyphicons-halflings-regular.eot
(0    x   tqq (Bglyphicons-halflings-regular.svg
(0    x   tqq (Bglyphicons-halflings-regular.ttf
(0    x   tqq (Bglyphicons-halflings-regular.woff
(0    x   mqq (Bglyphicons-halflings-regular.woff2
(0    tqq (Bimages
(0    x   tqq (B1 - copia.png
(0    x   tqq (B1.png
(0    x   tqq (B2.png
(0    x   tqq (B3.png
(0    x   tqq (B4.png
(0    x   tqq (B5.png
(0    x   tqq (Ba.png
(0    x   tqq (Barrow-left.png
(0    x   tqq (Barrow-right.png
(0    x   tqq (Bbg.jpg
(0    x   tqq (Bcloud.png
(0    x   tqq (Bi1.png
(0    x   tqq (Bi2.png
(0    x   tqq (Bi3.png
(0    x   tqq (Bi4.png
(0    x   tqq (Bimg1.png
(0    x   tqq (Block.png
(0    x   tqq (Blogo.png
(0    x   tqq (Bpic1.png
(0    x   tqq (Bpic4.jpg
(0    x   tqq (Btick.png
(0    x   mqq (Buser.png
(0    tqq (Bjs
(0    x   tqq (BChart.js
(0    x   tqq (Bbootstrap.js
(0    x   tqq (Bbootstrap.min.js
(0    x   tqq (Bclassie.js
(0    x   tqq (Bclndr.js
(0    x   tqq (Bcustom.js
(0    x   tqq (Bd3.v3.js
(0    x   tqq (Bjquery-1.11.1.min.js
(0    x   tqq (Bjquery-1.4.2.min.js
(0    x   tqq (Bjquery.circlechart.js
(0    x   tqq (Bjquery.min.js
(0    x   tqq (Bjquery.nicescroll.js
(0    x   tqq (Bjquery.timers.js
(0    x   tqq (Bjquery.vmap.js
(0    x   tqq (Bjquery.vmap.sampledata.js
(0    x   tqq (Bjquery.vmap.world.js
(0    x   tqq (BmetisMenu.min.js
(0    x   tqq (Bmodernizr.custom.js
(0    x   tqq (Bmoment-2.2.1.js
(0    x   tqq (Brickshaw.js
(0    x   tqq (Bscripts.js
(0    x   tqq (Bsite.js
(0    x   tqq (Bskycons.js
(0    x   tqq (Bunderscore-min.js
(0    x   tqq (Bvalidator.min.js
(0    x   mqq (Bwow.min.js
(0    mqq (Blib
(0        tqq (Bbootstrap
(0        x   tqq (BLICENSE
(0        x   tqq (Bcss
(0        x   x   mqq (Bbootstrap.min.css
(0        x   tqq (Bdist
(0        x   x   tqq (Bcss
(0        x   x   x   tqq (Bbootstrap-grid.css
(0        x   x   x   tqq (Bbootstrap-grid.css.map
(0        x   x   x   tqq (Bbootstrap-grid.min.css
(0        x   x   x   tqq (Bbootstrap-grid.min.css.map
(0        x   x   x   tqq (Bbootstrap-grid.rtl.css
(0        x   x   x   tqq (Bbootstrap-grid.rtl.css.map
(0        x   x   x   tqq (Bbootstrap-grid.rtl.min.css
(0        x   x   x   tqq (Bbootstrap-grid.rtl.min.css.map
(0        x   x   x   tqq (Bbootstrap-reboot.css
(0        x   x   x   tqq (Bbootstrap-reboot.css.map
(0        x   x   x   tqq (Bbootstrap-reboot.min.css
(0        x   x   x   tqq (Bbootstrap-reboot.min.css.map
(0        x   x   x   tqq (Bbootstrap-reboot.rtl.css
(0        x   x   x   tqq (Bbootstrap-reboot.rtl.css.map
(0        x   x   x   tqq (Bbootstrap-reboot.rtl.min.css
(0        x   x   x   tqq (Bbootstrap-reboot.rtl.min.css.map
(0        x   x   x   tqq (Bbootstrap-utilities.css
(0        x   x   x   tqq (Bbootstrap-utilities.css.map
(0        x   x   x   tqq (Bbootstrap-utilities.min.css
(0        x   x   x   tqq (Bbootstrap-utilities.min.css.map
(0        x   x   x   tqq (Bbootstrap-utilities.rtl.css
(0        x   x   x   tqq (Bbootstrap-utilities.rtl.css.map
(0        x   x   x   tqq (Bbootstrap-utilities.rtl.min.css
(0        x   x   x   tqq (Bbootstrap-utilities.rtl.min.css.map
(0        x   x   x   tqq (Bbootstrap.css
(0        x   x   x   tqq (Bbootstrap.css.map
(0        x   x   x   tqq (Bbootstrap.min.css
(0        x   x   x   tqq (Bbootstrap.min.css.map
(0        x   x   x   tqq (Bbootstrap.rtl.css
(0        x   x   x   tqq (Bbootstrap.rtl.css.map
(0        x   x   x   tqq (Bbootstrap.rtl.min.css
(0        x   x   x   mqq (Bbootstrap.rtl.min.css.map
(0        x   x   mqq (Bjs
(0        x   x       tqq (Bbootstrap.bundle.js
(0        x   x       tqq (Bbootstrap.bundle.js.map
(0        x   x       tqq (Bbootstrap.bundle.min.js
(0        x   x       tqq (Bbootstrap.bundle.min.js.map
(0        x   x       tqq (Bbootstrap.esm.js
(0        x   x       tqq (Bbootstrap.esm.js.map
(0        x   x       tqq (Bbootstrap.esm.min.js
(0        x   x       tqq (Bbootstrap.esm.min.js.map
(0        x   x       tqq (Bbootstrap.js
(0        x   x       tqq (Bbootstrap.js.map
(0        x   x       tqq (Bbootstrap.min.js
(0        x   x       mqq (Bbootstrap.min.js.map
(0        x   mqq (Bjs
(0        x       mqq (Bbootstrap.bundle.min.js
(0        tqq (Bjquery
(0        x   tqq (BLICENSE.txt
(0        x   mqq (Bdist
(0        x       tqq (Bjquery.js
(0        x       tqq (Bjquery.min.js
(0        x       mqq (Bjquery.min.map
(0        tqq (Bjquery-validation
(0        x   tqq (BLICENSE.md
(0        x   mqq (Bdist
(0        x       tqq (Badditional-methods.js
(0        x       tqq (Badditional-methods.min.js
(0        x       tqq (Bjquery.validate.js
(0        x       mqq (Bjquery.validate.min.js
(0        mqq (Bjquery-validation-unobtrusive
(0            tqq (BLICENSE.txt
(0            tqq (Bjquery.validate.unobtrusive.js
(0            mqq (Bjquery.validate.unobtrusive.min.js

24 directories, 171 files
```

---

## Archivo (csproj): `Kuotasmig.Core.csproj`

```xml
<Project Sdk="Microsoft.NET.Sdk.Web">

  <PropertyGroup>
    <TargetFramework>net8.0</TargetFramework>
    <Nullable>enable</Nullable>
    <ImplicitUsings>enable</ImplicitUsings>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="Microsoft.Data.SqlClient" Version="6.0.2" />
    <PackageReference Include="Microsoft.VisualStudio.Web.CodeGeneration.Design" Version="9.0.0" />
  </ItemGroup>

</Project>

```

---

## Archivo (txt): `find_live_errors.txt`

```text

```

---

## Archivo (ico): `wwwroot/favicon.ico`

[Contenido de archivo tipo 'ico' omitido (solo listado)]

---

## Archivo (css): `wwwroot/css/bootstrap.min.css`

[Contenido de archivo tipo 'css' omitido (solo listado)]

---

## Archivo (css): `wwwroot/css/clndr.css`

[Contenido de archivo tipo 'css' omitido (solo listado)]

---

## Archivo (css): `wwwroot/css/style2.css`

[Contenido de archivo tipo 'css' omitido (solo listado)]

---

## Archivo (css): `wwwroot/css/bootstrap.css`

[Contenido de archivo tipo 'css' omitido (solo listado)]

---

## Archivo (css): `wwwroot/css/lines.css`

[Contenido de archivo tipo 'css' omitido (solo listado)]

---

## Archivo (css): `wwwroot/css/animate.css`

[Contenido de archivo tipo 'css' omitido (solo listado)]

---

## Archivo (css): `wwwroot/css/custom.css`

[Contenido de archivo tipo 'css' omitido (solo listado)]

---

## Archivo (css): `wwwroot/css/style.css`

[Contenido de archivo tipo 'css' omitido (solo listado)]

---

## Archivo (css): `wwwroot/css/font-awesome.css`

[Contenido de archivo tipo 'css' omitido (solo listado)]

---

## Archivo (css): `wwwroot/css/site.css`

[Contenido de archivo tipo 'css' omitido (solo listado)]

---

## Archivo (css): `wwwroot/css/jqvmap.css`

[Contenido de archivo tipo 'css' omitido (solo listado)]

---

## Archivo (png): `wwwroot/images/tick.png`

[Contenido de imagen omitido]

---

## Archivo (png): `wwwroot/images/1 - copia.png`

[Contenido de imagen omitido]

---

## Archivo (png): `wwwroot/images/arrow-right.png`

[Contenido de imagen omitido]

---

## Archivo (png): `wwwroot/images/lock.png`

[Contenido de imagen omitido]

---

## Archivo (png): `wwwroot/images/user.png`

[Contenido de imagen omitido]

---

## Archivo (png): `wwwroot/images/i1.png`

[Contenido de imagen omitido]

---

## Archivo (png): `wwwroot/images/pic1.png`

[Contenido de imagen omitido]

---

## Archivo (png): `wwwroot/images/i2.png`

[Contenido de imagen omitido]

---

## Archivo (png): `wwwroot/images/i3.png`

[Contenido de imagen omitido]

---

## Archivo (png): `wwwroot/images/logo.png`

[Contenido de imagen omitido]

---

## Archivo (png): `wwwroot/images/cloud.png`

[Contenido de imagen omitido]

---

## Archivo (png): `wwwroot/images/arrow-left.png`

[Contenido de imagen omitido]

---

## Archivo (png): `wwwroot/images/i4.png`

[Contenido de imagen omitido]

---

## Archivo (png): `wwwroot/images/img1.png`

[Contenido de imagen omitido]

---

## Archivo (jpg): `wwwroot/images/pic4.jpg`

[Contenido de imagen omitido]

---

## Archivo (png): `wwwroot/images/4.png`

[Contenido de imagen omitido]

---

## Archivo (png): `wwwroot/images/5.png`

[Contenido de imagen omitido]

---

## Archivo (png): `wwwroot/images/a.png`

[Contenido de imagen omitido]

---

## Archivo (png): `wwwroot/images/2.png`

[Contenido de imagen omitido]

---

## Archivo (png): `wwwroot/images/3.png`

[Contenido de imagen omitido]

---

## Archivo (png): `wwwroot/images/1.png`

[Contenido de imagen omitido]

---

## Archivo (jpg): `wwwroot/images/bg.jpg`

[Contenido de imagen omitido]

---

## Archivo (js): `wwwroot/js/jquery-1.11.1.min.js`

[Contenido de archivo tipo 'js' omitido (solo listado)]

---

## Archivo (js): `wwwroot/js/jquery.vmap.sampledata.js`

[Contenido de archivo tipo 'js' omitido (solo listado)]

---

## Archivo (js): `wwwroot/js/jquery.vmap.world.js`

[Contenido de archivo tipo 'js' omitido (solo listado)]

---

## Archivo (js): `wwwroot/js/skycons.js`

[Contenido de archivo tipo 'js' omitido (solo listado)]

---

## Archivo (js): `wwwroot/js/clndr.js`

[Contenido de archivo tipo 'js' omitido (solo listado)]

---

## Archivo (js): `wwwroot/js/Chart.js`

[Contenido de archivo tipo 'js' omitido (solo listado)]

---

## Archivo (js): `wwwroot/js/jquery.nicescroll.js`

[Contenido de archivo tipo 'js' omitido (solo listado)]

---

## Archivo (js): `wwwroot/js/classie.js`

[Contenido de archivo tipo 'js' omitido (solo listado)]

---

## Archivo (js): `wwwroot/js/rickshaw.js`

[Contenido de archivo tipo 'js' omitido (solo listado)]

---

## Archivo (js): `wwwroot/js/validator.min.js`

[Contenido de archivo tipo 'js' omitido (solo listado)]

---

## Archivo (js): `wwwroot/js/d3.v3.js`

[Contenido de archivo tipo 'js' omitido (solo listado)]

---

## Archivo (js): `wwwroot/js/bootstrap.js`

[Contenido de archivo tipo 'js' omitido (solo listado)]

---

## Archivo (js): `wwwroot/js/wow.min.js`

[Contenido de archivo tipo 'js' omitido (solo listado)]

---

## Archivo (js): `wwwroot/js/underscore-min.js`

[Contenido de archivo tipo 'js' omitido (solo listado)]

---

## Archivo (js): `wwwroot/js/custom.js`

[Contenido de archivo tipo 'js' omitido (solo listado)]

---

## Archivo (js): `wwwroot/js/metisMenu.min.js`

[Contenido de archivo tipo 'js' omitido (solo listado)]

---

## Archivo (js): `wwwroot/js/jquery.min.js`

[Contenido de archivo tipo 'js' omitido (solo listado)]

---

## Archivo (js): `wwwroot/js/jquery-1.4.2.min.js`

[Contenido de archivo tipo 'js' omitido (solo listado)]

---

## Archivo (js): `wwwroot/js/bootstrap.min.js`

[Contenido de archivo tipo 'js' omitido (solo listado)]

---

## Archivo (js): `wwwroot/js/jquery.circlechart.js`

[Contenido de archivo tipo 'js' omitido (solo listado)]

---

## Archivo (js): `wwwroot/js/scripts.js`

[Contenido de archivo tipo 'js' omitido (solo listado)]

---

## Archivo (js): `wwwroot/js/moment-2.2.1.js`

[Contenido de archivo tipo 'js' omitido (solo listado)]

---

## Archivo (js): `wwwroot/js/jquery.vmap.js`

[Contenido de archivo tipo 'js' omitido (solo listado)]

---

## Archivo (js): `wwwroot/js/modernizr.custom.js`

[Contenido de archivo tipo 'js' omitido (solo listado)]

---

## Archivo (js): `wwwroot/js/jquery.timers.js`

[Contenido de archivo tipo 'js' omitido (solo listado)]

---

## Archivo (js): `wwwroot/js/site.js`

[Contenido de archivo tipo 'js' omitido (solo listado)]

---

## Archivo (svg): `wwwroot/fonts/fontawesome-webfont.svg`

[Contenido de archivo tipo 'svg' omitido (solo listado)]

---

## Archivo (woff): `wwwroot/fonts/glyphicons-halflings-regular.woff`

[Contenido de archivo tipo 'woff' omitido (solo listado)]

---

## Archivo (eot): `wwwroot/fonts/glyphicons-halflings-regular.eot`

[Contenido de archivo tipo 'eot' omitido (solo listado)]

---

## Archivo (woff2): `wwwroot/fonts/glyphicons-halflings-regular.woff2`

[Contenido de archivo tipo 'woff2' omitido (solo listado)]

---

## Archivo (ttf): `wwwroot/fonts/glyphicons-halflings-regular.ttf`

[Contenido de archivo tipo 'ttf' omitido (solo listado)]

---

## Archivo (woff2): `wwwroot/fonts/fontawesome-webfont.woff2`

[Contenido de archivo tipo 'woff2' omitido (solo listado)]

---

## Archivo (ttf): `wwwroot/fonts/fontawesome-webfont.ttf`

[Contenido de archivo tipo 'ttf' omitido (solo listado)]

---

## Archivo (woff): `wwwroot/fonts/fontawesome-webfont.woff`

[Contenido de archivo tipo 'woff' omitido (solo listado)]

---

## Archivo (svg): `wwwroot/fonts/glyphicons-halflings-regular.svg`

[Contenido de archivo tipo 'svg' omitido (solo listado)]

---

## Archivo (eot): `wwwroot/fonts/fontawesome-webfont.eot`

[Contenido de archivo tipo 'eot' omitido (solo listado)]

---

## Archivo (json): `appsettings.json`

```json
{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  "AllowedHosts": "*",
  "ConnectionStrings":{
    "P2015ConnectionString": "Data Source=TU_SERVIDOR_SQL;Initial Catalog=P2015;User ID=lde;Password=Ara21819;Encrypt=False;TrustServerCertificate=True"
  }
}

```

---

## Archivo (cs): `Models/Usuario.cs`

```csharp
// Kuotasmig.Core/Models/Usuario.cs
namespace Kuotasmig.Core.Models
{
    public class Usuario
    {
        // Aunque la clase original tenía un ID implícito, es buena práctica definirlo.
        // Si tu tabla no tiene un ID y USUARIO es la clave primaria, ajústalo.
        public int ID { get; set; } // Asumiendo que tienes un ID, si no, quitar o adaptar.
        public string USUARIO { get; set; } = string.Empty;
        public string CONTRASEÑA { get; set; } = string.Empty; // ¡RECORDATORIO: Debe ser un hash!
        public string TIPO { get; set; } = string.Empty;
        public string NOMBRE { get; set; } = string.Empty;
    }
}
```

---

## Archivo (cs): `Models/CalculadoraEntry.cs`

```csharp
// Kuotasmig.Core/Models/CalculadoraEntry.cs
namespace Kuotasmig.Core.Models
{
    public class CalculadoraEntry
    {
        public int ID { get; set; } // Asumiendo un ID para la tabla Calculadora
        public string TEXTO { get; set; }= string.Empty;
    }
}
```

---

## Archivo (cs): `Models/FilaAmortizacion.cs`

```csharp
// Kuotasmig.Core/Models/FilaAmortizacion.cs
namespace Kuotasmig.Core.Models
{
    public class FilaAmortizacion
    {
        public string NumeroCuota { get; set; } = string.Empty;
        public string SaldoInicial { get; set; } = string.Empty;
        public string Cuota { get; set; } = string.Empty;
        public string Intereses { get; set; } = string.Empty;
        public string Amortizacion { get; set; } = string.Empty;
        public string SaldoCapital { get; set; } = string.Empty;
    }
}
```

---

## Archivo (json): `Properties/launchSettings.json`

```json
{
  "$schema": "http://json.schemastore.org/launchsettings.json",
  "iisSettings": {
    "windowsAuthentication": false,
    "anonymousAuthentication": true,
    "iisExpress": {
      "applicationUrl": "http://localhost:16211",
      "sslPort": 44368
    }
  },
  "profiles": {
    "http": {
      "commandName": "Project",
      "dotnetRunMessages": true,
      "launchBrowser": true,
      "applicationUrl": "http://localhost:5135",
      "environmentVariables": {
        "ASPNETCORE_ENVIRONMENT": "Development"
      }
    },
    "https": {
      "commandName": "Project",
      "dotnetRunMessages": true,
      "launchBrowser": true,
      "applicationUrl": "https://localhost:7063;http://localhost:5135",
      "environmentVariables": {
        "ASPNETCORE_ENVIRONMENT": "Development"
      }
    },
    "IIS Express": {
      "commandName": "IISExpress",
      "launchBrowser": true,
      "environmentVariables": {
        "ASPNETCORE_ENVIRONMENT": "Development"
      }
    }
  }
}

```

---

## Archivo (json): `appsettings.Development.json`

```json
{
  "DetailedErrors": true,
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  }
}

```

---

## Archivo (cs): `Data/BDService.cs`

```csharp
// Kuotasmig.Core/Data/BDService.cs
using Microsoft.Data.SqlClient;
using Microsoft.Extensions.Configuration;
using System;

namespace Kuotasmig.Core.Data // Asegúrate que el namespace coincida con tu estructura
{
    public class BDService
    {
        private readonly string _connectionString;

        public BDService(IConfiguration configuration)
        {
            _connectionString = configuration.GetConnectionString("P2015ConnectionString")!;
            if (string.IsNullOrEmpty(_connectionString))
            {
                throw new InvalidOperationException("La cadena de conexión 'P2015ConnectionString' no se encontró o está vacía en la configuración.");
            }
        }

        public SqlConnection ObtenerConexion()
        {
            return new SqlConnection(_connectionString);
        }
    }
}
```

---

## Archivo (cshtml): `Pages/RendimientoAnualReal.cshtml`

```html
﻿@page
@model Kuotasmig.Core.Pages.RendimientoAnualRealModel
@{
    ViewData["Title"] = "Cálculo de Rendimiento Anual Real";
    Layout = "_Layout";
}

<h1>@ViewData["Title"]</h1>
<hr />

<form method="post" class="mt-3">
    @Html.AntiForgeryToken()
    <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>

    @if (!string.IsNullOrEmpty(Model.ErrorMessage))
    {
        <div class="alert alert-danger">@Model.ErrorMessage</div>
    }

    <div class="row">
        <div class="col-md-6">
            <div class="form-group mb-3">
                <label asp-for="Input.TasaAnualFacial"></label>
                <div class="input-group">
                    <input asp-for="Input.TasaAnualFacial" class="form-control" type="number" step="any" />
                    <span class="input-group-text">%</span>
                </div>
                <span asp-validation-for="Input.TasaAnualFacial" class="text-danger"></span>
            </div>
        </div>
        <div class="col-md-6">
            <div class="form-group mb-3">
                <label asp-for="Input.NumeroDePagos"></label>
                <input asp-for="Input.NumeroDePagos" class="form-control" type="number" step="1" />
                <span asp-validation-for="Input.NumeroDePagos" class="text-danger"></span>
            </div>
        </div>
    </div>

    <div class="form-group mb-3">
        <button type="submit" asp-page-handler="Calcular" class="btn btn-primary">Calcular Rendimiento</button>
        <button type="submit" asp-page-handler="Limpiar" class="btn btn-secondary" formnovalidate>Limpiar</button>
    </div>

    @if (!string.IsNullOrEmpty(Model.ResultadoRendimientoAnual))
    {
        <div class="alert alert-success mt-3">
            <h4>Rendimiento Anual Real: @Model.ResultadoRendimientoAnual</h4>
        </div>
    }
</form>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}
```

---

## Archivo (cs): `Pages/Default.cshtml.cs`

```csharp
// Kuotasmig.Core/Pages/Default.cshtml.cs
using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;

namespace Kuotasmig.Core.Pages
{
    public class DefaultModel : PageModel
    {
        public string NombreUsuario { get; private set; }
        public string TipoUsuario { get; private set; }
        public bool IsUserLoggedIn { get; private set; }


        public IActionResult OnGet()
        {
            // Leer de la sesión (esto es temporal hasta que implementes Identity)
            NombreUsuario = HttpContext.Session.GetString("loginNOMBRE");
            TipoUsuario = HttpContext.Session.GetString("loginTIPOUSUARIO");
            IsUserLoggedIn = !string.IsNullOrEmpty(HttpContext.Session.GetString("loginUSUARIO"));

            if (!IsUserLoggedIn)
            {
                // Si no hay sesión, redirigir al Login
                return RedirectToPage("/Login");
            }
            return Page();
        }

        public IActionResult OnPostLogout()
        {
            // Lógica para cerrar sesión (temporal)
            HttpContext.Session.Clear();
            // Con Identity sería: await _signInManager.SignOutAsync();
            return RedirectToPage("/Login");
        }
    }
}
```

---

## Archivo (cshtml): `Pages/Privacy.cshtml`

```html
﻿@page
@model PrivacyModel
@{
    ViewData["Title"] = "Privacy Policy";
}
<h1>@ViewData["Title"]</h1>

<p>Use this page to detail your site's privacy policy.</p>

```

---

## Archivo (cs): `Pages/Login.cshtml.cs`

```csharp
// Kuotasmig.Core/Pages/Login.cshtml.cs
using Kuotasmig.Core.Models;
using Kuotasmig.Core.Services;
using Microsoft.AspNetCore.Http; // Para HttpContext.Session
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;
using System.ComponentModel.DataAnnotations;
using System.Threading.Tasks; // Para Task<IActionResult>

namespace Kuotasmig.Core.Pages
{
    public class LoginModel : PageModel
    {
        private readonly UsuarioService _usuarioService;

        public LoginModel(UsuarioService usuarioService)
        {
            _usuarioService = usuarioService;
        }

        [BindProperty]
        public InputModel Input { get; set; } = new InputModel();

        public string ErrorMessage { get; set; }

        public class InputModel
        {
            [Required(ErrorMessage = "El campo Usuario es obligatorio.")]
            public string Usuario { get; set; } = string.Empty;

            [Required(ErrorMessage = "El campo Contraseña es obligatorio.")]
            [DataType(DataType.Password)]
            public string Contraseña { get; set; } = string.Empty;
        }

        public IActionResult OnGet()
        {
            // Si el usuario ya está autenticado (usando ASP.NET Core Identity o cookies de sesión),
            // redirigirlo a la página principal.
            // Esto es solo un ejemplo de cómo podrías leer la sesión.
            if (!string.IsNullOrEmpty(HttpContext.Session.GetString("loginUSUARIO")))
            {
                return RedirectToPage("/Default"); // O tu página principal
            }
            return Page();
        }

        public async Task<IActionResult> OnPost()
        {
            if (!ModelState.IsValid)
            {
                return Page();
            }

            // ADVERTENCIA DE SEGURIDAD:
            // El siguiente código es para propósitos de migración y NO ES SEGURO para producción
            // porque compara contraseñas en texto plano.
            // DEBES implementar ASP.NET Core Identity y comparar contraseñas hasheadas.
            Usuario usuarioEncontrado = _usuarioService.Buscar(Input.Usuario, Input.Contraseña);

            if (usuarioEncontrado != null)
            {
                // Autenticación exitosa (LÓGICA TEMPORAL DE SESIÓN)
                // En una aplicación real, aquí usarías SignInManager de ASP.NET Core Identity
                // para crear una cookie de autenticación segura.
                HttpContext.Session.SetString("loginUSUARIO", usuarioEncontrado.USUARIO);
                HttpContext.Session.SetString("loginNOMBRE", usuarioEncontrado.NOMBRE);
                HttpContext.Session.SetString("loginTIPOUSUARIO", usuarioEncontrado.TIPO);

                // Ejemplo de cómo sería con Identity (simplificado):
                // var result = await _signInManager.PasswordSignInAsync(Input.Usuario, Input.Contraseña, isPersistent: false, lockoutOnFailure: false);
                // if (result.Succeeded) { return RedirectToPage("/Default"); }

                return RedirectToPage("/Default"); // Redirigir a la página principal después del login
            }
            else
            {
                ErrorMessage = "**USUARIO Y/O CONTRASEÑA INCORRECTOS";
                return Page();
            }
        }
    }
}
```

---

## Archivo (cshtml): `Pages/Default.cshtml`

```html
@page
@model Kuotasmig.Core.Pages.DefaultModel
@{
    ViewData["Title"] = "Inicio";
    // Aquí sí usarías tu layout principal, por ejemplo _Layout.cshtml
    // Layout = "_Layout";
}

<h1>Bienvenido a KuotasMig Core!</h1>

@if (!string.IsNullOrEmpty(Model.NombreUsuario))
{
    <p>Hola, @Model.NombreUsuario!</p>
    <p>Tipo de Usuario: @Model.TipoUsuario</p>
    <form method="post" asp-page-handler="Logout">
        <button type="submit" class="btn btn-link">Cerrar Sesión</button>
    </form>
}
else
{
    <p>No has iniciado sesión.</p>
    <a asp-page="/Login">Iniciar Sesión</a>
}
```

---

## Archivo (cs): `Pages/DiasTranscurridos360.cshtml.cs`

```csharp
// Kuotasmig.Core/Pages/DiasTranscurridos360.cshtml.cs
using Kuotasmig.Core.Services;
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;
using System;
using System.ComponentModel.DataAnnotations;

namespace Kuotasmig.Core.Pages
{
    public class DiasTranscurridos360Model : PageModel
    {
        private readonly CalculoAmortizacionService _calculoService;

        public DiasTranscurridos360Model(CalculoAmortizacionService calculoService)
        {
            _calculoService = calculoService;
        }

        [BindProperty]
        public InputModel Input { get; set; } = new InputModel();

        public int? DiasCalculados { get; set; }
        public string? ErrorMessage { get; set; }

        public class InputModel
        {
            [Required(ErrorMessage = "La fecha 'Desde' es obligatoria.")]
            [DataType(DataType.Date)]
            [Display(Name = "Fecha Desde")]
            public DateTime? FechaDesde { get; set; }

            [Required(ErrorMessage = "La fecha 'Hasta' es obligatoria.")]
            [DataType(DataType.Date)]
            [Display(Name = "Fecha Hasta")]
            public DateTime? FechaHasta { get; set; }
        }

        public void OnGet()
        {
            Input.FechaDesde = DateTime.Today;
            Input.FechaHasta = DateTime.Today;
        }

        public IActionResult OnPostCalcular()
        {
            if (!ModelState.IsValid)
            {
                DiasCalculados = null;
                return Page();
            }

            if (Input.FechaDesde!.Value > Input.FechaHasta!.Value) // Usamos ! porque ModelState es válido
            {
                ErrorMessage = "La 'Fecha Hasta' no puede ser anterior a la 'Fecha Desde'.";
                DiasCalculados = null;
                return Page();
            }

            DiasCalculados = _calculoService.CalcularDiasTranscurridosBase360(Input.FechaDesde!.Value, Input.FechaHasta!.Value);
            ErrorMessage = null;
            return Page();
        }

        public IActionResult OnPostLimpiar()
        {
            ModelState.Clear();
            Input = new InputModel { FechaDesde = DateTime.Today, FechaHasta = DateTime.Today };
            DiasCalculados = null;
            ErrorMessage = null;
            return Page();
        }
    }
}
```

---

## Archivo (cs): `Pages/Privacy.cshtml.cs`

```csharp
﻿using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;

namespace Kuotasmig.Core.Pages;

public class PrivacyModel : PageModel
{
    private readonly ILogger<PrivacyModel> _logger;

    public PrivacyModel(ILogger<PrivacyModel> logger)
    {
        _logger = logger;
    }

    public void OnGet()
    {
    }
}


```

---

## Archivo (cshtml): `Pages/_ViewImports.cshtml`

```html
﻿@using Kuotasmig.Core
@namespace Kuotasmig.Core.Pages
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

```

---

## Archivo (cshtml): `Pages/Error.cshtml`

```html
﻿@page
@model ErrorModel
@{
    ViewData["Title"] = "Error";
}

<h1 class="text-danger">Error.</h1>
<h2 class="text-danger">An error occurred while processing your request.</h2>

@if (Model.ShowRequestId)
{
    <p>
        <strong>Request ID:</strong> <code>@Model.RequestId</code>
    </p>
}

<h3>Development Mode</h3>
<p>
    Swapping to the <strong>Development</strong> environment displays detailed information about the error that occurred.
</p>
<p>
    <strong>The Development environment shouldn't be enabled for deployed applications.</strong>
    It can result in displaying sensitive information from exceptions to end users.
    For local debugging, enable the <strong>Development</strong> environment by setting the <strong>ASPNETCORE_ENVIRONMENT</strong> environment variable to <strong>Development</strong>
    and restarting the app.
</p>

```

---

## Archivo (cs): `Pages/PlanillaDeAmortizacion.cshtml.cs`

```csharp
// Kuotasmig.Core/Pages/PlanillaDeAmortizacion.cshtml.cs
using Kuotasmig.Core.Models;
using Kuotasmig.Core.Services;
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;

namespace Kuotasmig.Core.Pages
{
    public class PlanillaDeAmortizacionModel : PageModel
    {
        private readonly CalculoAmortizacionService _calculoService;

        public PlanillaDeAmortizacionModel(CalculoAmortizacionService calculoService)
        {
            _calculoService = calculoService;
        }

        [BindProperty]
        public InputModel Input { get; set; } = new InputModel();

        public List<FilaAmortizacion>? Planilla { get; set; }
        public string? CuotaCalculada { get; set; }
        public string? MensajeError { get; set; }


        public class InputModel
        {
            [Required(ErrorMessage = "El capital es obligatorio.")]
            [Range(0.01, double.MaxValue, ErrorMessage = "El capital debe ser mayor a cero.")]
            [Display(Name = "Capital ($ o U.I.)")]
            public double? Capital { get; set; }

            [Required(ErrorMessage = "La tasa anual es obligatoria.")]
            [Range(0.000001, double.MaxValue, ErrorMessage = "La tasa debe ser mayor a cero.")] // No puede ser 0 exacto para la fórmula estándar
            [Display(Name = "Tasa de Interés Anual (%)")]
            public double? TasaAnual { get; set; }

            [Required(ErrorMessage = "La cantidad de cuotas es obligatoria.")]
            [Range(1, int.MaxValue, ErrorMessage = "La cantidad de cuotas debe ser al menos 1.")]
            [Display(Name = "Cantidad de Cuotas (Meses)")]
            public int? CantidadCuotas { get; set; }
        }

        public void OnGet()
        {
            // Lógica para cuando la página se carga por GET, si es necesaria
        }

        public IActionResult OnPostCalcular()
        {
            if (!ModelState.IsValid)
            {
                return Page();
            }

            var resultado = _calculoService.GenerarPlanilla(
                Input.Capital.Value,
                Input.TasaAnual.Value,
                Input.CantidadCuotas.Value
            );

            if (resultado.Error)
            {
                MensajeError = resultado.MensajeError;
                Planilla = null;
                CuotaCalculada = null;
            }
            else
            {
                Planilla = resultado.Planilla;
                CuotaCalculada = resultado.CuotaCalculada.ToString("N2");
                MensajeError = null;
            }
            return Page();
        }

        public IActionResult OnPostLimpiar()
        {
            ModelState.Clear();
            Input = new InputModel();
            Planilla = null;
            CuotaCalculada = null;
            MensajeError = null;
            return Page();
        }

        // La exportación a Excel requerirá una biblioteca de terceros o un enfoque diferente.
        // No se puede replicar directamente el método ExportToExcel de Web Forms.
        // Podrías generar un archivo CSV o usar una biblioteca como EPPlus o ClosedXML.
        // Por ahora, esta funcionalidad quedará pendiente.
        public IActionResult OnPostExportarExcel()
        {
            // Lógica de exportación a implementar
            // Ejemplo rápido de CSV (requeriría más trabajo para formato Excel):
            if (Planilla == null || !Planilla.Any())
            {
                 TempData["ErrorExportacion"] = "No hay datos para exportar.";
                return Page();
            }
            // Esta es una implementación muy básica.
            // En una app real, usarías una librería para Excel (EPPlus, ClosedXML) o CSVHelper
            // ... (Lógica para generar el archivo) ...
            // return File(bytes, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "PlanillaAmortizacion.xlsx");

            MensajeError = "Funcionalidad de exportar a Excel pendiente de implementación completa.";
            return Page();
        }
    }
}
```

---

## Archivo (cs): `Pages/SumarDiasACiertaFecha.cshtml.cs`

```csharp
// Kuotasmig.Core/Pages/SumarDiasACiertaFecha.cshtml.cs
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;
using System;
using System.ComponentModel.DataAnnotations;

namespace Kuotasmig.Core.Pages
{
    public class SumarDiasACiertaFechaModel : PageModel
    {
        [BindProperty]
        public InputModel Input { get; set; } = new InputModel();

        public string? FechaResultado { get; set; } // Para mostrar la fecha calculada
        public string? ErrorMessage { get; set; }

        public class InputModel
        {
            [Required(ErrorMessage = "La fecha de inicio es obligatoria.")]
            [DataType(DataType.Date)]
            [Display(Name = "Fecha Desde")]
            public DateTime? FechaInicio { get; set; }

            [Required(ErrorMessage = "El número de días a sumar es obligatorio.")]
            [Range(0, int.MaxValue, ErrorMessage = "Los días a sumar deben ser un número positivo.")]
            [Display(Name = "Días a Sumar")]
            public int? DiasASumar { get; set; }
        }

        public void OnGet()
        {
            // Inicializar con valores por defecto si es necesario, como en el original
            Input.FechaInicio = DateTime.Today;
            Input.DiasASumar = 0; // O un valor por defecto que prefieras
        }

        public IActionResult OnPostCalcular()
        {
            if (!ModelState.IsValid)
            {
                FechaResultado = null; // Limpiar resultado si hay error de validación
                return Page();
            }

            // ModelState.IsValid ya ha verificado que FechaInicio y DiasASumar no son null
            // debido a [Required], por lo que podemos usar el operador null-forgiving (!)
            DateTime fechaCalculada = Input.FechaInicio!.Value.AddDays(Input.DiasASumar!.Value);
            FechaResultado = fechaCalculada.ToShortDateString();
            ErrorMessage = null; // Limpiar cualquier mensaje de error previo

            return Page();
        }

        public IActionResult OnPostLimpiar()
        {
            ModelState.Clear(); // Limpia los errores de validación
            Input = new InputModel { FechaInicio = DateTime.Today, DiasASumar = 0 }; // Restablece a valores por defecto
            FechaResultado = null;
            ErrorMessage = null;
            return Page();
        }
    }
}
```

---

## Archivo (cshtml): `Pages/Shared/_Layout.cshtml`

```html
﻿@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor HttpContextAccessor
@* El resto de tus directivas @page, @model (si las tuviera un layout, aunque es raro para _Layout) *@

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - KuotasMig Core</title>

    @* Bootstrap (instalado con LibMan) *@
    <link rel="stylesheet" href="~/lib/bootstrap/css/bootstrap.min.css" />

    @* Font Awesome (copiado de tu proyecto original) *@
    <link rel="stylesheet" href="~/css/font-awesome.css" asp-append-version="true" />

    @* Tu CSS principal (style.css) *@
    <link rel="stylesheet" href="~/css/style.css" asp-append-version="true" />

    @* Otros CSS de tu proyecto original que hayas copiado a wwwroot/css *@
    <link rel="stylesheet" href="~/css/custom.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/clndr.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/jqvmap.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/lines.css" asp-append-version="true" />
    @* <link rel="stylesheet" href="~/css/style2.css" asp-append-version="true" /> Si lo necesitas *@

    @* CSS específico del sitio generado por la plantilla de ASP.NET Core (opcional, puedes fusionarlo o eliminarlo si no lo usas) *@
    @* Comentado porque el error 404 indica que no existe. Crea wwwroot/css/site.css si lo necesitas.
       <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    *@
</head>
<body>
    <header>
        @* Tu estructura de navbar original era más compleja y estaba integrada con el sidebar
           Necesitarás recrearla aquí si quieres la misma apariencia.
           El siguiente es un navbar muy básico de Bootstrap 5 como placeholder.
        *@
        <nav class="navbar navbar-expand-sm navbar-toggleable-sm navbar-light bg-white border-bottom box-shadow mb-3">
            <div class="container">
                <a class="navbar-brand" asp-page="/Default">KuotasMig Core</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target=".navbar-collapse" aria-controls="navbarSupportedContent"
                        aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="navbar-collapse collapse d-sm-inline-flex justify-content-between">
                    <ul class="navbar-nav flex-grow-1">
                        <li class="nav-item">
                            <a class="nav-link text-dark" asp-page="/Default">Inicio</a>
                        </li>
                        @* Más links del navbar superior aquí *@
                    </ul>
                    <ul class="navbar-nav">
                        @if (HttpContextAccessor.HttpContext != null && !string.IsNullOrEmpty(HttpContextAccessor.HttpContext.Session.GetString("loginUSUARIO")))
                        {
                            <li class="nav-item">
                                <span class="navbar-text me-3">
                                    Hola, @HttpContextAccessor.HttpContext.Session.GetString("loginNOMBRE")!
                                </span>
                            </li>
                            <li class="nav-item">
                                <form method="post" asp-page="/Default" asp-page-handler="Logout" class="d-inline">
                                    <button type="submit" class="nav-link btn btn-link text-dark">Cerrar Sesión</button>
                                </form>
                            </li>
                        }
                        else
                        {
                            <li class="nav-item">
                                <a class="nav-link text-dark" asp-page="/Login">Iniciar Sesión</a>
                            </li>
                        }
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    @* Esta es la estructura de wrapper y sidebar que tu CSS original (style.css y custom.css) parece esperar *@
    <div id="wrapper">
        <nav class="navbar-default sidebar" role="navigation"> @* Tu style.css da estilo a .navbar-default.sidebar *@
            <div class="sidebar-nav navbar-collapse">
                <ul class="nav" id="side-menu"> @* ID usado por metisMenu y custom.js *@
                    <li>
                        <a asp-page="/Default"><i class="fa fa-dashboard fa-fw nav_icon"></i> Dashboard</a>
                    </li>
                    <li>
                        <a href="#"><i class="fa fa-cogs fa-fw nav_icon"></i> Calculadoras <span class="fa arrow"></span></a>
                        <ul class="nav nav-second-level">
                            <li><a asp-page="/PlanillaDeAmortizacion">Planilla de Amortización</a></li>
                            <li><a asp-page="/CALCULODEMORADECUOTAS">Cálculo Mora Cuotas</a></li>
                            <li><a asp-page="/CÁLCULODECUOTASIGUALESYMENSUALESDECAPITALEINTERÉS">Cuotas Iguales (Pesos)</a></li>
                            <li><a asp-page="/CÁLCULODECUOTASIGUALESYMENSUALESDECAPITALEINTERÉSENUIYPESOS">Cuotas Iguales (UI y $)</a></li>
                            <li><a asp-page="/CANCELACIÓNANTICIPADADECUOTASMENSUALESDECAPITALEINTERÉS">Cancelación Anticipada</a></li>
                            <li><a asp-page="/CÁLCULODEMORADEUNCAPITAL">Mora de un Capital</a></li>
                            <li><a asp-page="/CÁLCULODEMORADEVARIASCUOTASMENSUALESIGUALES">Mora Varias Cuotas Iguales</a></li>
                            <li><a asp-page="/CÁLCULODEMORADEVARIASCUOTASMENSUALESIGUALESTODASVENCIDAS">Mora Varias Cuotas (Vencidas)</a></li>
                            <li><a asp-page="/CÁLCULODEINTERÉSCOMPUESTO">Interés Compuesto</a></li>
                            <li><a asp-page="/CalculoDeInteresSimple">Interés Simple</a></li>
                            <li><a asp-page="/DESCUENTODEUNDOCUMENTOAUNATASADEDESCUENTOCOMPUESTA">Descuento Documento</a></li>
                            <<li><a asp-page="/DiasTranscurridos360">Días Transcurridos (360)</a></li>
                            <li><a asp-page="/DIASTRANSCURRIDOS365">Días Transcurridos (365)</a></li>
                            <li><a asp-page="/EQUIVALENCIADETASAS">Equivalencia de Tasas</a></li>
                            <li><a asp-page="/LIQUIDACIONDEMORADEDISTINTOSMONTOSYDESDEDIFERENTESFECHAS">Liquidación Mora Dist. Montos</a></li>
                            <li><a asp-page="/RendimientoAnualReal">Rendimiento Anual Real</a></li>
                            <li><a asp-page="/SumarDiasACiertaFecha">Sumar Días a Fecha</a></li>
                        </ul>
                    </li>
                    <li>
                        <a asp-page="/typography"><i class="fa fa-font fa-fw nav_icon"></i> Tipografía (Ejemplo)</a>
                    </li>
                    @* Más elementos del menú lateral aquí, replicando la estructura de tu typography.html original si es necesario *@
                </ul>
            </div>
        </nav>

        <div id="page-wrapper">
            <div class="container-fluid pt-3 pb-3"> @* Añadí pt-3 y pb-3 para padding *@
                <main role="main">
                    @RenderBody()
                </main>
            </div>
        </div>
    </div>

    <footer class="border-top footer text-muted mt-auto py-3">
        <div class="container">
            <div class="copy_layout text-center"> @* Añadí text-center para el copyright *@
                <p>Copyright &copy; @DateTime.Now.Year Modern. All Rights Reserved | Design by <a href="http://w3layouts.com/" target="_blank">W3layouts</a> </p>
            </div>
        </div>
    </footer>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/js/bootstrap.bundle.min.js"></script>

    @* Scripts JS de tu proyecto original. Asegúrate del orden y dependencias. *@
    <script src="~/js/metisMenu.min.js" asp-append-version="true"></script>
    <script src="~/js/custom.js" asp-append-version="true"></script>

    @* Si site.js de la plantilla de VS Code no es necesario o causa conflictos, puedes comentarlo/eliminarlo.
       Si tu `site.js` original (el que usa moment y clndr) tiene funcionalidad general, asegúrate
       de que es el que se está cargando aquí o fusiona su contenido.
    *@
    @* <script src="~/js/site.js" asp-append-version="true"></script> *@

    @* Scripts para gráficos y calendarios. Comentados inicialmente hasta que se aborde su migración específica. *@
    <script src="~/js/moment-2.2.1.js" asp-append-version="true"></script>
    <script src="~/js/underscore-min.js" asp-append-version="true"></script>
    <script src="~/js/clndr.js" asp-append-version="true"></script>
    <script src="~/js/site.js" asp-append-version="true"></script> @* Este es el que usa clndr *@


    @* <script src="~/js/d3.v3.js" asp-append-version="true"></script> *@
    @* <script src="~/js/rickshaw.js" asp-append-version="true"></script> *@
    @* <script src="~/js/Chart.js" asp-append-version="true"></script> *@
    @* <script src="~/js/jquery.vmap.js" asp-append-version="true"></script> *@
    @* <script src="~/js/jquery.vmap.world.js" asp-append-version="true"></script> *@
    @* <script src="~/js/jquery.vmap.sampledata.js" asp-append-version="true"></script> *@

    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
```

---

## Archivo (css): `Pages/Shared/_Layout.cshtml.css`

[Contenido de archivo tipo 'css' omitido (solo listado)]

---

## Archivo (cshtml): `Pages/Shared/_ValidationScriptsPartial.cshtml`

```html
﻿<script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
<script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>

```

---

## Archivo (cshtml): `Pages/PlanillaDeAmortizacion.cshtml`

```html
﻿@page
@model Kuotasmig.Core.Pages.PlanillaDeAmortizacionModel
@{
    ViewData["Title"] = "Planilla de Amortización";
    // Asumiendo que usas el _Layout.cshtml que configuramos
    Layout = "_Layout";
}

<h1>@ViewData["Title"]</h1>
<hr />

<form method="post">
    <div asp-validation-summary="ModelOnly" class="text-danger"></div>

    <div class="row">
        <div class="col-md-4">
            <div class="form-group mb-3">
                <label asp-for="Input.Capital" class="control-label"></label>
                <input asp-for="Input.Capital" class="form-control" type="number" step="0.01" />
                <span asp-validation-for="Input.Capital" class="text-danger"></span>
            </div>
        </div>
        <div class="col-md-4">
            <div class="form-group mb-3">
                <label asp-for="Input.TasaAnual" class="control-label"></label>
                <div class="input-group">
                    <input asp-for="Input.TasaAnual" class="form-control" type="number" step="0.000001" />
                    <span class="input-group-text">%</span>
                </div>
                <span asp-validation-for="Input.TasaAnual" class="text-danger"></span>
            </div>
        </div>
        <div class="col-md-4">
            <div class="form-group mb-3">
                <label asp-for="Input.CantidadCuotas" class="control-label"></label>
                <input asp-for="Input.CantidadCuotas" class="form-control" type="number" />
                <span asp-validation-for="Input.CantidadCuotas" class="text-danger"></span>
            </div>
        </div>
    </div>

    <div class="form-group mb-3">
        <button type="submit" asp-page-handler="Calcular" class="btn btn-primary">Calcular</button>
        <button type="submit" asp-page-handler="Limpiar" class="btn btn-secondary" formnovalidate>Limpiar</button>
        @* <button type="submit" asp-page-handler="ExportarExcel" class="btn btn-success">Exportar a Excel</button> *@
    </div>

    @if (!string.IsNullOrEmpty(Model.MensajeError))
    {
        <div class="alert alert-danger">@Model.MensajeError</div>
    }

    @if (!string.IsNullOrEmpty(Model.CuotaCalculada))
    {
        <div class="alert alert-info">
            <h4>Monto de la Cuota: @Model.CuotaCalculada</h4>
        </div>
    }

    @if (Model.Planilla != null && Model.Planilla.Any())
    {
        <h3 class="mt-4">Planilla de Amortización</h3>
        <div class="table-responsive">
            <table class="table table-striped table-bordered">
                <thead>
                    <tr>
                        <th>Nº CUOTA</th>
                        <th>SALDO INICIAL</th>
                        <th>CUOTA</th>
                        <th>INTERESES</th>
                        <th>AMORTIZACIÓN</th>
                        <th>SALDO CAPITAL</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.Planilla)
                    {
                        <tr>
                            <td>@item.NumeroCuota</td>
                            <td>@item.SaldoInicial</td>
                            <td>@item.Cuota</td>
                            <td>@item.Intereses</td>
                            <td>@item.Amortizacion</td>
                            <td>@item.SaldoCapital</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
        <form method="post" asp-page-handler="ExportarExcel" class="mt-3">
             @* Campos ocultos para pasar los parámetros de nuevo si es necesario para la exportación *@
            <input type="hidden" asp-for="Input.Capital" />
            <input type="hidden" asp-for="Input.TasaAnual" />
            <input type="hidden" asp-for="Input.CantidadCuotas" />
            <button type="submit" class="btn btn-success">Exportar a Excel (Pendiente)</button>
        </form>
    }
</form>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}
```

---

## Archivo (cs): `Pages/CalculoDeInteresCompuesto.cshtml.cs`

```csharp
// Kuotasmig.Core/Pages/CalculoDeInteresCompuesto.cshtml.cs
using Kuotasmig.Core.Services;
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;
using System;
using System.ComponentModel.DataAnnotations;
using System.Globalization;

namespace Kuotasmig.Core.Pages
{
    public class CalculoDeInteresCompuestoModel : PageModel
    {
        private readonly CalculoAmortizacionService _calculoService;

        public CalculoDeInteresCompuestoModel(CalculoAmortizacionService calculoService)
        {
            _calculoService = calculoService;
        }

        // --- Modelo para el primer cálculo (Tasa Mensual) ---
        [BindProperty(SupportsGet = true, Name = "InputMensual")] // SupportsGet para mantener valores si se refresca
        public InputTasaMensualModel InputMensual { get; set; } = new InputTasaMensualModel();
        public string? TotalCalculoMensual { get; set; }
        public string? InteresesCalculoMensual { get; set; }
        public int? DiasCalculadosMensual { get; set; }


        // --- Modelo para el segundo cálculo (Tasa Anual) ---
        [BindProperty(SupportsGet = true, Name = "InputAnual")]
        public InputTasaAnualModel InputAnual { get; set; } = new InputTasaAnualModel();
        public string? TotalCalculoAnual { get; set; }
        public string? InteresesCalculoAnual { get; set; }
        public string? TasaMensualEquivalenteAnual { get; set; }
        public int? DiasCalculadosAnual { get; set; }
        
        public string? ErrorMessage { get; set; }


        public class InputTasaMensualModel
        {
            [Display(Name = "Capital ($)")]
            public double? Capital { get; set; }

            [Display(Name = "Tasa de Interés Mensual (%)")]
            public double? TasaInteresMensual { get; set; }

            [DataType(DataType.Date)]
            [Display(Name = "Fecha Desde")]
            public DateTime? FechaDesde { get; set; }

            [DataType(DataType.Date)]
            [Display(Name = "Fecha Hasta")]
            public DateTime? FechaHasta { get; set; }
        }

        public class InputTasaAnualModel
        {
            [Display(Name = "Capital ($)")]
            public double? Capital { get; set; }

            [Display(Name = "Tasa de Interés Anual (%)")]
            public double? TasaInteresAnual { get; set; }

            [DataType(DataType.Date)]
            [Display(Name = "Fecha Desde")]
            public DateTime? FechaDesde { get; set; }

            [DataType(DataType.Date)]
            [Display(Name = "Fecha Hasta")]
            public DateTime? FechaHasta { get; set; }
        }


        public void OnGet()
        {
            InputMensual.FechaDesde = DateTime.Today;
            InputMensual.FechaHasta = DateTime.Today;
            InputAnual.FechaDesde = DateTime.Today;
            InputAnual.FechaHasta = DateTime.Today;
        }

        public IActionResult OnPostCalcularMensual()
        {
            DiasCalculadosMensual = null; // Reset
            TotalCalculoMensual = null;
            InteresesCalculoMensual = null;

            if (InputMensual.Capital == null || InputMensual.TasaInteresMensual == null || 
                InputMensual.FechaDesde == null || InputMensual.FechaHasta == null)
            {
                ErrorMessage = "Todos los campos son obligatorios para el cálculo con tasa mensual.";
                return Page();
            }
             if (InputMensual.FechaDesde.Value > InputMensual.FechaHasta.Value)
            {
                ErrorMessage = "La 'Fecha Hasta' no puede ser anterior a la 'Fecha Desde' para el cálculo con tasa mensual.";
                return Page();
            }


            TimeSpan diferencia = InputMensual.FechaHasta.Value.Subtract(InputMensual.FechaDesde.Value);
            DiasCalculadosMensual = diferencia.Days;

            var resultado = _calculoService.CalcularInteresCompuesto(
                InputMensual.Capital.Value,
                InputMensual.TasaInteresMensual.Value, // Tasa ya es mensual
                DiasCalculadosMensual.Value
            );

            TotalCalculoMensual = resultado.MontoFinal.ToString("N2", CultureInfo.InvariantCulture);
            InteresesCalculoMensual = resultado.InteresesDevengados.ToString("N2", CultureInfo.InvariantCulture);
            ErrorMessage = null;
            return Page();
        }

        public IActionResult OnPostCalcularAnual()
        {
            DiasCalculadosAnual = null; // Reset
            TotalCalculoAnual = null;
            InteresesCalculoAnual = null;
            TasaMensualEquivalenteAnual = null;

            if (InputAnual.Capital == null || InputAnual.TasaInteresAnual == null || 
                InputAnual.FechaDesde == null || InputAnual.FechaHasta == null)
            {
                ErrorMessage = "Todos los campos son obligatorios para el cálculo con tasa anual.";
                return Page();
            }
            if (InputAnual.FechaDesde.Value > InputAnual.FechaHasta.Value)
            {
                ErrorMessage = "La 'Fecha Hasta' no puede ser anterior a la 'Fecha Desde' para el cálculo con tasa anual.";
                return Page();
            }

            TimeSpan diferencia = InputAnual.FechaHasta.Value.Subtract(InputAnual.FechaDesde.Value);
            DiasCalculadosAnual = diferencia.Days;

            // Convertir Tasa Anual a Tasa Mensual Efectiva
            double tasaAnual = InputAnual.TasaInteresAnual.Value / 100.0;
            double tasaMensualEfectiva = (Math.Pow(1.0 + tasaAnual, 1.0 / 12.0) - 1.0) * 100.0;
            TasaMensualEquivalenteAnual = tasaMensualEfectiva.ToString("N7", CultureInfo.InvariantCulture) + "%";


            var resultado = _calculoService.CalcularInteresCompuesto(
                InputAnual.Capital.Value,
                tasaMensualEfectiva,
                DiasCalculadosAnual.Value
            );

            TotalCalculoAnual = resultado.MontoFinal.ToString("N2", CultureInfo.InvariantCulture);
            InteresesCalculoAnual = resultado.InteresesDevengados.ToString("N2", CultureInfo.InvariantCulture);
            ErrorMessage = null;
            return Page();
        }

        public IActionResult OnPostLimpiar()
        {
            ModelState.Clear();
            InputMensual = new InputTasaMensualModel { FechaDesde = DateTime.Today, FechaHasta = DateTime.Today };
            InputAnual = new InputTasaAnualModel { FechaDesde = DateTime.Today, FechaHasta = DateTime.Today };
            TotalCalculoMensual = null;
            InteresesCalculoMensual = null;
            DiasCalculadosMensual = null;
            TotalCalculoAnual = null;
            InteresesCalculoAnual = null;
            TasaMensualEquivalenteAnual = null;
            DiasCalculadosAnual = null;
            ErrorMessage = null;
            return Page();
        }
    }
}
```

---

## Archivo (cs): `Pages/CalculoDeInteresSimple.cshtml.cs`

```csharp
using Kuotasmig.Core.Services; // Asumiendo que CalculoFinancieroService está aquí
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;
using System.ComponentModel.DataAnnotations;
using System.Globalization;

namespace Kuotasmig.Core.Pages
{
    public class CalculoDeInteresSimpleModel : PageModel
    {
        private readonly CalculoAmortizacionService _calculoService; // CAMBIADO AQUÍ

        public CalculoDeInteresSimpleModel(CalculoAmortizacionService calculoService) // CAMBIADO AQUÍ
        {
            _calculoService = calculoService;
        }

        // --- Propiedades para el primer cálculo (Tiempo en Días) ---
        [BindProperty]
        public InputDiasModel? InputDias { get; set; } = new InputDiasModel();
        public string? ResultadoInteresDias { get; set; }

        // --- Propiedades para el segundo cálculo (Tiempo en Meses) ---
        [BindProperty]
        public InputMesesModel? InputMeses { get; set; } = new InputMesesModel();
        public string? ResultadoInteresMeses { get; set; }

        // --- Propiedades para el tercer cálculo (Tiempo en Años) ---
        [BindProperty]
        public InputAñosModel? InputAños { get; set; } = new InputAñosModel();
        public string? ResultadoInteresAños { get; set; }

        public string? ErrorMessage { get; set; }


        public class InputDiasModel
        {
            [Display(Name = "Capital ($)")]
            public double? Capital { get; set; }
            [Display(Name = "Tasa de Interés Anual (%)")]
            public double? TasaAnual { get; set; }
            [Display(Name = "Tiempo (Días)")]
            public int? TiempoDias { get; set; }
        }

        public class InputMesesModel
        {
            [Display(Name = "Capital ($)")]
            public double? Capital { get; set; }
            [Display(Name = "Tasa de Interés Anual (%)")]
            public double? TasaAnual { get; set; }
            [Display(Name = "Tiempo (Meses)")]
            public int? TiempoMeses { get; set; }
        }

        public class InputAñosModel
        {
            [Display(Name = "Capital ($)")]
            public double? Capital { get; set; }
            [Display(Name = "Tasa de Interés Anual (%)")]
            public double? TasaAnual { get; set; }
            [Display(Name = "Tiempo (Años)")]
            public int? TiempoAños { get; set; }
        }

        public void OnGet() { }

        public IActionResult OnPostCalcularInteresDias()
        {
            if (InputDias?.Capital != null && InputDias?.TasaAnual != null && InputDias?.TiempoDias != null)
            {
                double resultado = _calculoService.CalcularInteresSimplePorDias(InputDias.Capital.Value, InputDias.TasaAnual.Value, InputDias.TiempoDias.Value);
                ResultadoInteresDias = resultado.ToString("N2", CultureInfo.InvariantCulture);
            }
            else ErrorMessage = "Faltan datos para el cálculo por días.";
            return Page();
        }

        public IActionResult OnPostCalcularInteresMeses()
        {
            if (InputMeses?.Capital != null && InputMeses?.TasaAnual != null && InputMeses?.TiempoMeses != null)
            {
                double resultado = _calculoService.CalcularInteresSimplePorMeses(InputMeses.Capital.Value, InputMeses.TasaAnual.Value, InputMeses.TiempoMeses.Value);
                ResultadoInteresMeses = resultado.ToString("N2", CultureInfo.InvariantCulture);
            }
            else ErrorMessage = "Faltan datos para el cálculo por meses.";
            return Page();
        }

        public IActionResult OnPostCalcularInteresAños()
        {
             if (InputAños?.Capital != null && InputAños?.TasaAnual != null && InputAños?.TiempoAños != null)
            {
                double resultado = _calculoService.CalcularInteresSimplePorAños(InputAños.Capital.Value, InputAños.TasaAnual.Value, InputAños.TiempoAños.Value);
                ResultadoInteresAños = resultado.ToString("N2", CultureInfo.InvariantCulture);
            }
            else ErrorMessage = "Faltan datos para el cálculo por años.";
            return Page();
        }

        public IActionResult OnPostLimpiar() // Un solo limpiar para todos o individuales?
        {
            ModelState.Clear();
            InputDias = new InputDiasModel();
            InputMeses = new InputMesesModel();
            InputAños = new InputAñosModel();
            ResultadoInteresDias = null;
            ResultadoInteresMeses = null;
            ResultadoInteresAños = null;
            ErrorMessage = null;
            return Page();
        }
    }
}

```

---

## Archivo (cs): `Pages/Error.cshtml.cs`

```csharp
using System.Diagnostics;
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;

namespace Kuotasmig.Core.Pages;

[ResponseCache(Duration = 0, Location = ResponseCacheLocation.None, NoStore = true)]
[IgnoreAntiforgeryToken]
public class ErrorModel : PageModel
{
    public string? RequestId { get; set; }

    public bool ShowRequestId => !string.IsNullOrEmpty(RequestId);

    private readonly ILogger<ErrorModel> _logger;

    public ErrorModel(ILogger<ErrorModel> logger)
    {
        _logger = logger;
    }

    public void OnGet()
    {
        RequestId = Activity.Current?.Id ?? HttpContext.TraceIdentifier;
    }
}


```

---

## Archivo (cshtml): `Pages/DiasTranscurridos360.cshtml`

```html
﻿@page
@model Kuotasmig.Core.Pages.DiasTranscurridos360Model
@{
    ViewData["Title"] = "Calcular Días Transcurridos (Base 360)";
    Layout = "_Layout";
}

<h1>@ViewData["Title"]</h1>
<hr />

<form method="post" class="mt-3">
    @Html.AntiForgeryToken()
    <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>

    @if (!string.IsNullOrEmpty(Model.ErrorMessage))
    {
        <div class="alert alert-danger">@Model.ErrorMessage</div>
    }

    <div class="row">
        <div class="col-md-5">
            <div class="form-group mb-3">
                <label asp-for="Input.FechaDesde"></label>
                <input asp-for="Input.FechaDesde" class="form-control" />
                <span asp-validation-for="Input.FechaDesde" class="text-danger"></span>
            </div>
        </div>
        <div class="col-md-5">
            <div class="form-group mb-3">
                <label asp-for="Input.FechaHasta"></label>
                <input asp-for="Input.FechaHasta" class="form-control" />
                <span asp-validation-for="Input.FechaHasta" class="text-danger"></span>
            </div>
        </div>
    </div>

    <div class="form-group mb-3">
        <button type="submit" asp-page-handler="Calcular" class="btn btn-primary">Calcular Días (Base 360)</button>
        <button type="submit" asp-page-handler="Limpiar" class="btn btn-secondary" formnovalidate>Limpiar</button>
    </div>

    @if (Model.DiasCalculados.HasValue)
    {
        <div class="alert alert-success mt-3">
            <h4>Días Transcurridos (Base 360): @Model.DiasCalculados</h4>
        </div>
    }
</form>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}
```

---

## Archivo (cshtml): `Pages/SumarDiasACiertaFecha.cshtml`

```html
﻿@page
@model Kuotasmig.Core.Pages.SumarDiasACiertaFechaModel
@{
    ViewData["Title"] = "Sumar Días Corridos a Cierta Fecha";
    Layout = "_Layout"; // Asumiendo que usas tu layout principal
}

<h1>@ViewData["Title"]</h1>
<hr />

<form method="post" class="mt-3">
    @Html.AntiForgeryToken() @* Buena práctica para seguridad *@
    
    @* Mostrar errores de validación del modelo general o errores personalizados *@
    <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>

    @if (!string.IsNullOrEmpty(Model.ErrorMessage))
    {
        <div class="alert alert-danger">@Model.ErrorMessage</div>
    }

    <div class="row">
        <div class="col-md-5">
            <div class="form-group mb-3">
                <label asp-for="Input.FechaInicio" class="form-label"></label>
                <input asp-for="Input.FechaInicio" class="form-control" />
                <span asp-validation-for="Input.FechaInicio" class="text-danger"></span>
            </div>
        </div>
        <div class="col-md-5">
            <div class="form-group mb-3">
                <label asp-for="Input.DiasASumar" class="form-label"></label>
                <input asp-for="Input.DiasASumar" type="number" class="form-control" />
                <span asp-validation-for="Input.DiasASumar" class="text-danger"></span>
            </div>
        </div>
    </div>

    <div class="form-group mb-3">
        <button type="submit" asp-page-handler="Calcular" class="btn btn-primary">Calcular Fecha Resultante</button>
        <button type="submit" asp-page-handler="Limpiar" class="btn btn-secondary" formnovalidate>Limpiar</button>
    </div>

    @if (!string.IsNullOrEmpty(Model.FechaResultado))
    {
        <div class="alert alert-success mt-3">
            <h4>Fecha Resultante: @Model.FechaResultado</h4>
        </div>
    }
</form>

@* Sección para scripts de validación del lado del cliente *@
@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}
```

---

## Archivo (cshtml): `Pages/Login.cshtml`

```html
@page
@model Kuotasmig.Core.Pages.LoginModel
@{
    ViewData["Title"] = "Iniciar Sesión";
    Layout = null; // Para una página de login simple sin el layout principal
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - KuotasMig Core</title>
    @* Asegúrate que las rutas a los CSS son correctas y que los archivos existen en wwwroot/css *@
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" /> @* Bootstrap moderno *@
    <link rel="stylesheet" href="~/css/style.css" /> @* Tu CSS principal *@
    <link rel="stylesheet" href="~/css/font-awesome.css" />
    <style>
        /* Estilos específicos del login original si los tenía */
        body#login {
            /* background: url(../images/bg.jpg)no-repeat; */ /* Debería ser ~/images/bg.jpg */
            background-size: cover;
            min-height: 100vh; /* Mejor que un min-height fijo */
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Roboto', sans-serif; /* Del style.css */
        }

        .app-cam { /* Del style.css, ajusta según sea necesario */
            width: 350px; /* Un ancho fijo para el ejemplo */
            padding: 20px;
            background-color: rgba(255,255,255,0.9); /* Fondo semitransparente si tienes imagen */
            border-radius: 5px;
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
        }

        .form-heading { /* Del style.css */
            margin-bottom: 1.5em;
            text-align: center;
            color: #000;
            font-size: 18px;
            text-transform: uppercase;
        }
         /* Ajusta los estilos de los inputs y botones según tu style.css */
        .app-cam input[type="text"],
        .app-cam input[type="password"] {
            width: 100%;
            padding: 12px;
            color: #555; /* Ajustado para mejor legibilidad */
            font-size: 0.95em;
            outline: none;
            font-weight: 300;
            border: 1px solid #ccc; /* Borde estándar */
            background: #fff; /* Fondo blanco */
            margin: 0 0 1em 0;
            border-radius: 2px;
        }

        .app-cam input[type="submit"], .btn-login-custom {
            font-size: 14px;
            font-weight: 500; /* Un poco más de peso para el botón */
            color: #fff;
            cursor: pointer;
            outline: none;
            padding: 12px 15px;
            width: 100%;
            border: none;
            background: rgb(6, 217, 149); /* Color de tu style.css */
            border-radius: 2px;
            text-transform: uppercase;
            transition: background-color 0.3s ease;
        }
        .app-cam input[type="submit"]:hover, .btn-login-custom:hover {
            background: rgb(3, 197, 135); /* Un poco más oscuro al pasar el mouse */
        }

    </style>
</head>
<body id="login"> @* Aplica el ID si tu CSS lo requiere para el fondo *@
    <div class="app-cam">
        @* <div class="login-logo">
            <img src="~/images/logo.png" alt="Logo" />  Reemplaza con tu logo si tienes 
        </div> *@
        <h2 class="form-heading">Iniciar Sesión</h2>
        <form method="post">
            @Html.AntiForgeryToken()

            <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>

            <div class="form-group">
                <input asp-for="Input.Usuario" type="text" class="form-control" placeholder="Usuario" required />
                <span asp-validation-for="Input.Usuario" class="text-danger"></span>
            </div>

            <div class="form-group">
                <input asp-for="Input.Contraseña" type="password" class="form-control" placeholder="Contraseña" required />
                <span asp-validation-for="Input.Contraseña" class="text-danger"></span>
            </div>

            @if (!string.IsNullOrEmpty(Model.ErrorMessage))
            {
                <div class="alert alert-danger" role="alert">
                    @Model.ErrorMessage
                </div>
            }

            <button type="submit" class="btn-login-custom">Ingresar</button>

            @*
            <div class="login-social-link">
                <a href="#" class="facebook">Facebook</a>
                <a href="#" class="twitter">Twitter</a>
            </div>
            <ul class="new">
                <li class="new_left"><p><a href="#">Olvidaste tu contraseña ?</a></p></li>
                <li class="new_right"><p class="sign">Nuevo aquí? <a href="#">Registrate</a></p></li>
                <div class="clearfix"></div>
            </ul>
            *@
        </form>
    </div>

    @* Referencias a JS. Coloca jQuery antes que bootstrap.js *@
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    @* <script src="~/js/custom.js"></script> Si tienes JS personalizado *@
</body>
</html>
```

---

## Archivo (cshtml): `Pages/Index.cshtml`

```html
﻿@page
@model IndexModel
@{
    ViewData["Title"] = "Home page";
}

<div class="text-center">
    <h1 class="display-4">Welcome</h1>
    <p>Learn about <a href="https://learn.microsoft.com/aspnet/core">building Web apps with ASP.NET Core</a>.</p>
</div>

```

---

## Archivo (cshtml): `Pages/_ViewStart.cshtml`

```html
﻿@{
    Layout = "_Layout";
}

```

---

## Archivo (cshtml): `Pages/CalculoDeInteresSimple.cshtml`

```html
﻿@page
@model Kuotasmig.Core.Pages.CalculoDeInteresSimpleModel
@{
    ViewData["Title"] = "Cálculo de Interés Simple";
    Layout = "_Layout";
}

<h1>@ViewData["Title"]</h1>
<hr />

@if (!string.IsNullOrEmpty(Model.ErrorMessage))
{
    <div class="alert alert-danger">@Model.ErrorMessage</div>
}

<form method="post">
    @Html.AntiForgeryToken()

    @* --- Sección Cálculo por Días --- *@
    <div class="card mb-4">
        <div class="card-header"><h4>Interés Simple (Tiempo en Días)</h4></div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-3 form-group">
                    <label asp-for="InputDias.Capital"></label>
                    <input asp-for="InputDias.Capital" class="form-control" type="number" step="any" />
                    <span asp-validation-for="InputDias.Capital" class="text-danger"></span>
                </div>
                <div class="col-md-3 form-group">
                    <label asp-for="InputDias.TasaAnual"></label>
                    <input asp-for="InputDias.TasaAnual" class="form-control" type="number" step="any" />
                    <span asp-validation-for="InputDias.TasaAnual" class="text-danger"></span>
                </div>
                <div class="col-md-3 form-group">
                    <label asp-for="InputDias.TiempoDias"></label>
                    <input asp-for="InputDias.TiempoDias" class="form-control" type="number" />
                    <span asp-validation-for="InputDias.TiempoDias" class="text-danger"></span>
                </div>
                <div class="col-md-3 form-group align-self-end">
                    <button type="submit" asp-page-handler="CalcularInteresDias" class="btn btn-primary w-100">Calcular</button>
                </div>
            </div>
            @if (!string.IsNullOrEmpty(Model.ResultadoInteresDias))
            {
                <div class="alert alert-success mt-2">Intereses ($): @Model.ResultadoInteresDias</div>
            }
        </div>
    </div>

    @* --- Sección Cálculo por Meses --- *@
    <div class="card mb-4">
        <div class="card-header"><h4>Interés Simple (Tiempo en Meses)</h4></div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-3 form-group">
                    <label asp-for="InputMeses.Capital"></label>
                    <input asp-for="InputMeses.Capital" class="form-control" type="number" step="any" />
                    <span asp-validation-for="InputMeses.Capital" class="text-danger"></span>
                </div>
                <div class="col-md-3 form-group">
                    <label asp-for="InputMeses.TasaAnual"></label>
                    <input asp-for="InputMeses.TasaAnual" class="form-control" type="number" step="any" />
                    <span asp-validation-for="InputMeses.TasaAnual" class="text-danger"></span>
                </div>
                <div class="col-md-3 form-group">
                    <label asp-for="InputMeses.TiempoMeses"></label>
                    <input asp-for="InputMeses.TiempoMeses" class="form-control" type="number" />
                    <span asp-validation-for="InputMeses.TiempoMeses" class="text-danger"></span>
                </div>
                <div class="col-md-3 form-group align-self-end">
                    <button type="submit" asp-page-handler="CalcularInteresMeses" class="btn btn-primary w-100">Calcular</button>
                </div>
            </div>
            @if (!string.IsNullOrEmpty(Model.ResultadoInteresMeses))
            {
                <div class="alert alert-success mt-2">Intereses ($): @Model.ResultadoInteresMeses</div>
            }
        </div>
    </div>

    @* --- Sección Cálculo por Años --- *@
    <div class="card mb-4">
        <div class="card-header"><h4>Interés Simple (Tiempo en Años)</h4></div>
        <div class="card-body">
             <div class="row">
                <div class="col-md-3 form-group">
                    <label asp-for="InputAños.Capital"></label>
                    <input asp-for="InputAños.Capital" class="form-control" type="number" step="any" />
                    <span asp-validation-for="InputAños.Capital" class="text-danger"></span>
                </div>
                <div class="col-md-3 form-group">
                    <label asp-for="InputAños.TasaAnual"></label>
                    <input asp-for="InputAños.TasaAnual" class="form-control" type="number" step="any" />
                    <span asp-validation-for="InputAños.TasaAnual" class="text-danger"></span>
                </div>
                <div class="col-md-3 form-group">
                    <label asp-for="InputAños.TiempoAños"></label>
                    <input asp-for="InputAños.TiempoAños" class="form-control" type="number" />
                    <span asp-validation-for="InputAños.TiempoAños" class="text-danger"></span>
                </div>
                <div class="col-md-3 form-group align-self-end">
                    <button type="submit" asp-page-handler="CalcularInteresAños" class="btn btn-primary w-100">Calcular</button>
                </div>
            </div>
            @if (!string.IsNullOrEmpty(Model.ResultadoInteresAños))
            {
                <div class="alert alert-success mt-2">Intereses ($): @Model.ResultadoInteresAños</div>
            }
        </div>
    </div>

    <hr />
    <div class="form-group mt-3">
        <button type="submit" asp-page-handler="Limpiar" class="btn btn-secondary" formnovalidate>Limpiar Todos los Campos</button>
    </div>
</form>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}
```

---

## Archivo (cs): `Pages/RendimientoAnualReal.cshtml.cs`

```csharp
// Kuotasmig.Core/Pages/RendimientoAnualReal.cshtml.cs
using Kuotasmig.Core.Services; // O el namespace de tu servicio financiero
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;
using System.ComponentModel.DataAnnotations;
using System.Globalization;

namespace Kuotasmig.Core.Pages
{
    public class RendimientoAnualRealModel : PageModel
    {
        private readonly CalculoAmortizacionService _calculoService; // Usa el nombre de tu servicio

        public RendimientoAnualRealModel(CalculoAmortizacionService calculoService) // Usa el nombre de tu servicio
        {
            _calculoService = calculoService;
        }

        [BindProperty]
        public InputModel Input { get; set; } = new InputModel();

        public string? ResultadoRendimientoAnual { get; set; }
        public string? ErrorMessage {get; set;}

        public class InputModel
        {
            [Required(ErrorMessage = "La Tasa Anual Facial es obligatoria.")]
            [Display(Name = "Tasa Anual Facial (%)")]
            public double? TasaAnualFacial { get; set; }

            [Required(ErrorMessage = "El Número de Pagos es obligatorio.")]
            [Range(1, double.MaxValue, ErrorMessage = "El número de pagos debe ser al menos 1.")]
            [Display(Name = "Número de Pagos en el Año")]
            public double? NumeroDePagos { get; set; } // Aunque sea "número de pagos", el original lo trataba como double.
        }

        public void OnGet()
        {
            // Puedes inicializar valores por defecto si lo deseas
            // Input.TasaAnualFacial = 0;
            // Input.NumeroDePagos = 12; // Por ejemplo
        }

        public IActionResult OnPostCalcular()
        {
            if (!ModelState.IsValid)
            {
                ResultadoRendimientoAnual = null;
                return Page();
            }

            if (Input.NumeroDePagos.HasValue && Input.NumeroDePagos.Value == 0)
            {
                ErrorMessage = "El número de pagos no puede ser cero para este cálculo.";
                ResultadoRendimientoAnual = null;
                return Page();
            }

            double resultado = _calculoService.CalcularRendimientoAnualReal(
                Input.TasaAnualFacial!.Value, // Usamos ! porque ModelState es válido
                Input.NumeroDePagos!.Value
            );
            ResultadoRendimientoAnual = resultado.ToString("N", CultureInfo.InvariantCulture) + "%"; // "N" para formato numérico general
            ErrorMessage = null;
            return Page();
        }

        public IActionResult OnPostLimpiar()
        {
            ModelState.Clear();
            Input = new InputModel();
            ResultadoRendimientoAnual = null;
            ErrorMessage = null;
            return Page();
        }
    }
}
```

---

## Archivo (cs): `Pages/Index.cshtml.cs`

```csharp
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.RazorPages;

namespace Kuotasmig.Core.Pages;

public class IndexModel : PageModel
{
    private readonly ILogger<IndexModel> _logger;

    public IndexModel(ILogger<IndexModel> logger)
    {
        _logger = logger;
    }

    public void OnGet()
    {

    }
}

```

---

## Archivo (cshtml): `Pages/CalculoDeInteresCompuesto.cshtml`

```html
﻿@page
@model Kuotasmig.Core.Pages.CalculoDeInteresCompuestoModel
@{
    ViewData["Title"] = "Cálculo de Interés Compuesto";
    Layout = "_Layout";
}

<h1>@ViewData["Title"]</h1>
<hr />

@if (!string.IsNullOrEmpty(Model.ErrorMessage))
{
    <div class="alert alert-danger">@Model.ErrorMessage</div>
}

<div class="row">
    @* --- Columna para Cálculo con Tasa Mensual --- *@
    <div class="col-md-6">
        <div class="card mb-3">
            <div class="card-header"><h4>Con Tasa de Interés Mensual</h4></div>
            <div class="card-body">
                <form method="post" asp-page-handler="CalcularMensual">
                    @Html.AntiForgeryToken()
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>

                    <div class="form-group mb-2">
                        <label asp-for="InputMensual.Capital"></label>
                        <input asp-for="InputMensual.Capital" class="form-control" type="number" step="any" />
                        <span asp-validation-for="InputMensual.Capital" class="text-danger"></span>
                    </div>
                    <div class="form-group mb-2">
                        <label asp-for="InputMensual.TasaInteresMensual"></label>
                        <div class="input-group">
                            <input asp-for="InputMensual.TasaInteresMensual" class="form-control" type="number" step="any" />
                            <span class="input-group-text">%</span>
                        </div>
                        <span asp-validation-for="InputMensual.TasaInteresMensual" class="text-danger"></span>
                    </div>
                    <div class="form-group mb-2">
                        <label asp-for="InputMensual.FechaDesde"></label>
                        <input asp-for="InputMensual.FechaDesde" class="form-control" />
                        <span asp-validation-for="InputMensual.FechaDesde" class="text-danger"></span>
                    </div>
                    <div class="form-group mb-3">
                        <label asp-for="InputMensual.FechaHasta"></label>
                        <input asp-for="InputMensual.FechaHasta" class="form-control" />
                        <span asp-validation-for="InputMensual.FechaHasta" class="text-danger"></span>
                    </div>
                    <button type="submit" class="btn btn-primary">Calcular</button>
                </form>

                @if (Model.DiasCalculadosMensual.HasValue)
                {
                    <div class="alert alert-info mt-3">
                        Días Transcurridos: @Model.DiasCalculadosMensual<br />
                        Monto Total a Cobrar ($): <strong>@Model.TotalCalculoMensual</strong><br />
                        Intereses Devengados ($): <strong>@Model.InteresesCalculoMensual</strong>
                    </div>
                }
            </div>
        </div>
    </div>

    @* --- Columna para Cálculo con Tasa Anual --- *@
    <div class="col-md-6">
        <div class="card mb-3">
            <div class="card-header"><h4>Con Tasa de Interés Anual</h4></div>
            <div class="card-body">
                <form method="post" asp-page-handler="CalcularAnual">
                    @Html.AntiForgeryToken()
                     <div asp-validation-summary="ModelOnly" class="text-danger"></div>

                    <div class="form-group mb-2">
                        <label asp-for="InputAnual.Capital"></label>
                        <input asp-for="InputAnual.Capital" class="form-control" type="number" step="any" />
                        <span asp-validation-for="InputAnual.Capital" class="text-danger"></span>
                    </div>
                    <div class="form-group mb-2">
                        <label asp-for="InputAnual.TasaInteresAnual"></label>
                         <div class="input-group">
                            <input asp-for="InputAnual.TasaInteresAnual" class="form-control" type="number" step="any" />
                            <span class="input-group-text">%</span>
                        </div>
                        <span asp-validation-for="InputAnual.TasaInteresAnual" class="text-danger"></span>
                    </div>
                     <div class="form-group mb-2">
                        <label asp-for="InputAnual.FechaDesde"></label>
                        <input asp-for="InputAnual.FechaDesde" class="form-control" />
                        <span asp-validation-for="InputAnual.FechaDesde" class="text-danger"></span>
                    </div>
                    <div class="form-group mb-3">
                        <label asp-for="InputAnual.FechaHasta"></label>
                        <input asp-for="InputAnual.FechaHasta" class="form-control" />
                        <span asp-validation-for="InputAnual.FechaHasta" class="text-danger"></span>
                    </div>
                    <button type="submit" class="btn btn-primary">Calcular</button>
                </form>
                @if (Model.DiasCalculadosAnual.HasValue)
                {
                    <div class="alert alert-info mt-3">
                        Tasa Mensual Equivalente: @Model.TasaMensualEquivalenteAnual<br/>
                        Días Transcurridos: @Model.DiasCalculadosAnual<br />
                        Monto Total a Cobrar ($): <strong>@Model.TotalCalculoAnual</strong><br />
                        Intereses Devengados ($): <strong>@Model.InteresesCalculoAnual</strong>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

<form method="post" class="mt-3">
    @Html.AntiForgeryToken()
    <button type="submit" asp-page-handler="Limpiar" class="btn btn-secondary" formnovalidate>Limpiar Todos los Campos</button>
</form>


@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}
```

---

## Archivo (json): `libman.json`

```json
{
  "version": "3.0",
  "defaultProvider": "cdnjs",
  "libraries": [
    {
      "library": "bootstrap@5.3.2",
      "destination": "wwwroot/lib/bootstrap",
      "files": [
        "css/bootstrap.min.css",
        "js/bootstrap.bundle.min.js"
      ]
    }
  ]
}
```

---

## Archivo (cs): `Services/CalculoAmortizacionService.cs`

```csharp
// Kuotasmig.Core/Services/CalculoAmortizacionService.cs
using Kuotasmig.Core.Models;
using System;
using System.Collections.Generic;
using System.Globalization;
using System.Linq; // Necesario para .Sum() si lo usas

namespace Kuotasmig.Core.Services
{
    public class CalculoAmortizacionService // Puedes renombrar esta clase a CalculoFinancieroService si prefieres más adelante
    {
        // Dentro de la clase CalculoAmortizacionService (o tu servicio financiero)

        public class ResultadoInteresCompuesto
        {
            public double MontoFinal { get; set; }
            public double InteresesDevengados { get; set; }
        }

        public ResultadoInteresCompuesto CalcularInteresCompuesto(double capital, double tasaInteresMensualEfectiva, int numeroDeDias)
        {
            Console.WriteLine($"INTERÉS COMPUESTO (Servicio): C={capital}, TasaMensualEfec={tasaInteresMensualEfectiva}, Días={numeroDeDias}");

            if (capital <= 0 || numeroDeDias < 0) // La tasa puede ser 0
            {
                // Devolver el capital inicial si no hay días o el capital es cero/negativo
                return new ResultadoInteresCompuesto { MontoFinal = capital, InteresesDevengados = 0 };
            }

            // Convertir la tasa de interés mensual efectiva a una tasa diaria efectiva
            // Tasa Diaria = (1 + TasaMensualEfectiva)^(1/30) - 1
            // (Asumiendo 30 días por mes para consistencia con cómo se calculó la tasa mensual originalmente)
            double tasaDiariaEfectiva = Math.Pow(1.0 + (tasaInteresMensualEfectiva / 100.0), 1.0 / 30.0) - 1.0;

            // Si la tasa diaria efectiva es negativa (lo que podría pasar si la tasa mensual es -100%),
            // el monto final podría ser menor que el capital o incluso cero.
            // Si tasaDiariaEfectiva es -1 (tasa mensual -100%), Math.Pow daría 0.

            double montoFinal;
            if (tasaDiariaEfectiva <= -1) // Evitar problemas con Math.Pow si la base es <= 0
            {
                montoFinal = 0; // Si la tasa es -100% o peor, el capital se pierde.
            }
            else
            {
                montoFinal = capital * Math.Pow(1.0 + tasaDiariaEfectiva, numeroDeDias);
            }

            double interesesDevengados = montoFinal - capital;

            return new ResultadoInteresCompuesto
            {
                MontoFinal = montoFinal,
                InteresesDevengados = interesesDevengados
            };
        }
        public double CalcularRendimientoAnualReal(double tasaAnualFacial, double numeroDePagos)
        {
            Console.WriteLine($"RENDIMIENTO ANUAL REAL (Servicio): TasaFacial={tasaAnualFacial}, Pagos={numeroDePagos}");
            if (numeroDePagos == 0)
            {

                return 0;
            }
            return (100 * tasaAnualFacial) / numeroDePagos;
        }
        public int CalcularDiasTranscurridosBase360(DateTime fechaDesde, DateTime fechaHasta)
        {
            Console.WriteLine($"DÍAS 360 (Servicio): Desde={fechaDesde.ToShortDateString()}, Hasta={fechaHasta.ToShortDateString()}");

            // Replicando la lógica original
            double años = fechaHasta.Year - fechaDesde.Year;
            double meses = fechaHasta.Month - fechaDesde.Month;
            double dias = fechaHasta.Day - fechaDesde.Day;

            meses = meses + (años * 12);
            // La lógica original para días parecía intentar ajustar a múltiplos de 30.
            // Una forma común de 30/360 es: (Año2 - Año1) * 360 + (Mes2 - Mes1) * 30 + (Día2 - Día1)
            // Con ajustes si Día1 o Día2 son 31 (se tratan como 30) o si Día2 es el último de febrero.
            // Para simplificar y seguir tu lógica original aproximada:
            dias = dias + (meses * 30); 
            // La línea original "dias = ((((CDIAS * 100)/30)*30)/100)" parece que no tiene un efecto significativo
            // si CDIAS ya es un entero. Simplemente `dias = dias + (meses * 30);` es lo que hace.

            // Implementación más estándar del método 30E/360 (Europeo)
            int d1 = fechaDesde.Day;
            int m1 = fechaDesde.Month;
            int y1 = fechaDesde.Year;
            int d2 = fechaHasta.Day;
            int m2 = fechaHasta.Month;
            int y2 = fechaHasta.Year;

            if (d1 == 31) d1 = 30;
            if (d2 == 31) d2 = 30;

            return ((y2 - y1) * 360) + ((m2 - m1) * 30) + (d2 - d1);
        }
        // Clase interna para el resultado de la planilla de amortización
        public class ResultadoCalculoAmortizacion
        {
            public double CuotaCalculada { get; set; }
            public List<FilaAmortizacion> Planilla { get; set; } = new List<FilaAmortizacion>();
            public bool Error { get; set; } = false;
            public string? MensajeError { get; set; } // Permite null
        }

        public ResultadoCalculoAmortizacion GenerarPlanilla(double capital, double tasaAnualNominal, int cantidadCuotas)
        {
            var resultado = new ResultadoCalculoAmortizacion();

            if (capital <= 0 || tasaAnualNominal < 0 || cantidadCuotas <= 0) // Permitir tasa 0
            {
                resultado.Error = true;
                resultado.MensajeError = "Capital y cantidad de cuotas deben ser mayores a cero. La tasa debe ser mayor o igual a cero.";
                if (tasaAnualNominal < 0 && capital > 0 && cantidadCuotas > 0) // Caso especial para evitar error si solo la tasa es el problema
                {
                     resultado.MensajeError = "La tasa anual nominal no puede ser negativa.";
                }
                return resultado;
            }

            try
            {
                double tasaMensualEfectiva;
                if (tasaAnualNominal == 0)
                {
                    tasaMensualEfectiva = 0;
                }
                else
                {
                    tasaMensualEfectiva = Math.Pow(1.0 + (tasaAnualNominal / 100.0), 1.0 / 12.0) - 1.0;
                }


                if (Math.Abs(tasaMensualEfectiva) < 0.0000000001) // Comparación más segura para tasa cero o muy cercana
                {
                    resultado.CuotaCalculada = Math.Round(capital / cantidadCuotas, 2);
                    double saldoPendiente = capital;
                    for (int i = 1; i <= cantidadCuotas; i++)
                    {
                        string saldoInicialActualParaFila = saldoPendiente.ToString("N2", CultureInfo.InvariantCulture);
                        double intereses = 0;
                        double amortizacionEstaCuota = resultado.CuotaCalculada;
                        
                        if (i == cantidadCuotas) {
                             amortizacionEstaCuota = saldoPendiente; // Asegurar que la última amortización cubra el saldo exacto
                             resultado.CuotaCalculada = amortizacionEstaCuota; // La última cuota puede diferir ligeramente
                        }
                        
                        saldoPendiente -= amortizacionEstaCuota;

                        resultado.Planilla.Add(new FilaAmortizacion
                        {
                            NumeroCuota = i.ToString(),
                            SaldoInicial = saldoInicialActualParaFila,
                            Cuota = (i == cantidadCuotas) ? Math.Round(amortizacionEstaCuota, 2).ToString("N2", CultureInfo.InvariantCulture) : resultado.CuotaCalculada.ToString("N2", CultureInfo.InvariantCulture),
                            Intereses = intereses.ToString("N2", CultureInfo.InvariantCulture),
                            Amortizacion = Math.Round(amortizacionEstaCuota, 2).ToString("N2", CultureInfo.InvariantCulture),
                            SaldoCapital = Math.Round(Math.Abs(saldoPendiente) < 0.005 ? 0 : saldoPendiente, 2).ToString("N2", CultureInfo.InvariantCulture)
                        });
                    }
                    // Asegurar que la cuota general refleje la cuota regular si todas son iguales
                    if (cantidadCuotas > 0) resultado.CuotaCalculada = Math.Round(capital / cantidadCuotas, 2);
                    return resultado;
                }

                double factorAnualidad = (tasaMensualEfectiva * Math.Pow(1.0 + tasaMensualEfectiva, cantidadCuotas)) /
                                         (Math.Pow(1.0 + tasaMensualEfectiva, cantidadCuotas) - 1.0);

                double cuotaCalculadaPrecisa = capital * factorAnualidad;
                resultado.CuotaCalculada = Math.Round(cuotaCalculadaPrecisa, 2);

                double saldoCapital = capital;
                for (int i = 1; i <= cantidadCuotas; i++)
                {
                    string saldoInicialActualParaFila = saldoCapital.ToString("N2", CultureInfo.InvariantCulture);
                    double intereses = Math.Round(saldoCapital * tasaMensualEfectiva, 7);
                    double amortizacion = cuotaCalculadaPrecisa - intereses;
                    double cuotaParaEstaFila = cuotaCalculadaPrecisa;

                    if (i == cantidadCuotas)
                    {
                        amortizacion = saldoCapital;
                        cuotaParaEstaFila = amortizacion + intereses;
                    }
                    
                    saldoCapital -= amortizacion;

                    resultado.Planilla.Add(new FilaAmortizacion
                    {
                        NumeroCuota = i.ToString(),
                        SaldoInicial = saldoInicialActualParaFila,
                        Cuota = Math.Round(cuotaParaEstaFila, 2).ToString("N2", CultureInfo.InvariantCulture),
                        Intereses = Math.Round(intereses, 2).ToString("N2", CultureInfo.InvariantCulture),
                        Amortizacion = Math.Round(amortizacion, 2).ToString("N2", CultureInfo.InvariantCulture),
                        SaldoCapital = Math.Round(Math.Abs(saldoCapital) < 0.005 ? 0 : saldoCapital, 2).ToString("N2", CultureInfo.InvariantCulture)
                    });
                }
            }
            catch (Exception ex)
            {
                resultado.Error = true;
                resultado.MensajeError = "Error en el cálculo de la planilla: " + ex.Message;
            }
            return resultado;
        }

        // --- MÉTODOS PARA INTERÉS SIMPLE (MOCKEADOS/SIMULADOS) ---
        public double CalcularInteresSimplePorDias(double capital, double tasaAnualPorcentaje, int tiempoEnDias)
        {
            Console.WriteLine($"INTERÉS SIMPLE DÍAS (Servicio): C={capital}, T%={tasaAnualPorcentaje}, D={tiempoEnDias}");
            if (capital <= 0 || tasaAnualPorcentaje < 0 || tiempoEnDias <= 0) return 0;
            return (capital * tasaAnualPorcentaje * tiempoEnDias) / 36000.0;
        }

        public double CalcularInteresSimplePorMeses(double capital, double tasaAnualPorcentaje, int tiempoEnMeses)
        {
            Console.WriteLine($"INTERÉS SIMPLE MESES (Servicio): C={capital}, T%={tasaAnualPorcentaje}, M={tiempoEnMeses}");
            if (capital <= 0 || tasaAnualPorcentaje < 0 || tiempoEnMeses <= 0) return 0;
            return (capital * tasaAnualPorcentaje * tiempoEnMeses) / 1200.0;
        }

        public double CalcularInteresSimplePorAños(double capital, double tasaAnualPorcentaje, int tiempoEnAños)
        {
            Console.WriteLine($"INTERÉS SIMPLE AÑOS (Servicio): C={capital}, T%={tasaAnualPorcentaje}, A={tiempoEnAños}");
            if (capital <= 0 || tasaAnualPorcentaje < 0 || tiempoEnAños <= 0) return 0;
            return (capital * tasaAnualPorcentaje * tiempoEnAños) / 100.0;
        }

        // --- MÉTODOS PARA EQUIVALENCIA DE TASAS (MOCKEADOS/SIMULADOS) ---
        public double CalcularEquivalenciaDesdeTasaAnual(double tasaAnualNominal, int diasParaEquivalencia)
        {
            Console.WriteLine($"EQUIV ANUAL (Servicio): T%Anual={tasaAnualNominal}, DíasEq={diasParaEquivalencia}");
            if (diasParaEquivalencia <= 0 || tasaAnualNominal < -100) return 0; // Tasa -100% es el límite inferior
            double tasaDiariaEfectiva = Math.Pow(1.0 + (tasaAnualNominal / 100.0), 1.0 / 360.0) - 1.0;
            double tasaEquivalente = (Math.Pow(1.0 + tasaDiariaEfectiva, diasParaEquivalencia) - 1.0) * 100.0;
            return tasaEquivalente;
        }

        public double CalcularEquivalenciaDesdeTasaMensual(double tasaMensual, int diasCapitalizacionMensual)
        {
            Console.WriteLine($"EQUIV MENSUAL (Servicio): T%Mensual={tasaMensual}, DíasCap={diasCapitalizacionMensual}");
            if (diasCapitalizacionMensual <= 0 || tasaMensual < -100) return 0;
            double tasaAnualEfectiva = (Math.Pow(1.0 + (tasaMensual / 100.0), 360.0 / diasCapitalizacionMensual) - 1.0) * 100.0;
            return tasaAnualEfectiva;
        }

        public double CalcularEquivalenciaDesdeTasaDiaria(double tasaDiaria)
        {
            Console.WriteLine($"EQUIV DIARIA (Servicio): T%Diaria={tasaDiaria}");
            if (tasaDiaria < -100) return 0;
            double tasaMensualEfectiva = (Math.Pow(1.0 + (tasaDiaria / 100.0), 30.0) - 1.0) * 100.0;
            return tasaMensualEfectiva;
        }

        public double ConvertirLinealAnualAEfectivaAnual(double tasaLinealAnual)
        {
            Console.WriteLine($"LINEAL A EFECTIVA (Servicio): T%Lineal={tasaLinealAnual}");
            if (tasaLinealAnual < -100 * 12) return 0; // Aproximación
            double tasaMensual = tasaLinealAnual / 100.0 / 12.0;
            double tasaEfectivaAnual = (Math.Pow(1.0 + tasaMensual, 12.0) - 1.0) * 100.0;
            return tasaEfectivaAnual;
        }

        public double ConvertirEfectivaAnualALinealAnual(double tasaEfectivaAnual)
        {
            Console.WriteLine($"EFECTIVA A LINEAL (Servicio): T%Efectiva={tasaEfectivaAnual}");
             if (tasaEfectivaAnual < -100) return 0;
            double tasaMensualEquivalente = Math.Pow(1.0 + (tasaEfectivaAnual / 100.0), 1.0 / 12.0) - 1.0;
            double tasaLinealAnual = tasaMensualEquivalente * 12.0 * 100.0;
            return tasaLinealAnual;
        }
    }
}
```

---

## Archivo (cs): `Services/UsuarioService.cs`

```csharp
// Kuotasmig.Core/Services/UsuarioService.cs
using Kuotasmig.Core.Data;
using Kuotasmig.Core.Models;
using Microsoft.Data.SqlClient;
using System;

namespace Kuotasmig.Core.Services
{
    public class UsuarioService
    {
        private readonly BDService _bdService;

        public UsuarioService(BDService bdService)
        {
            _bdService = bdService ?? throw new ArgumentNullException(nameof(bdService));
        }

        public Usuario? Buscar(string usuarioParam, string contraseñaParam)
        {
            Usuario u = null;
            // ADVERTENCIA: Esta comparación de contraseña es insegura.
            // Se debe comparar el hash de la contraseña proporcionada con el hash almacenado.
            // Esto es solo para ilustrar la migración de la lógica de BD.

            using (SqlConnection conexion = _bdService.ObtenerConexion())
            {
                conexion.Open();
                string query = "SELECT USUARIO, CONTRASEÑA, TIPO, NOMBRE FROM USUARIO WHERE USUARIO = @usuario AND CONTRASEÑA = @contraseña";
                using (SqlCommand comando = new SqlCommand(query, conexion))
                {
                    comando.Parameters.AddWithValue("@usuario", usuarioParam);
                    comando.Parameters.AddWithValue("@contraseña", contraseñaParam); // DEBE SER HASH

                    using (SqlDataReader reader = comando.ExecuteReader())
                    {
                        if (reader.Read())
                        {
                            u = new Usuario // Usando la clase modelo
                            {
                                USUARIO = reader.GetString(0),
                                CONTRASEÑA = reader.GetString(1), // No almacenar/devolver contraseña en texto plano
                                TIPO = reader.GetString(2),
                                NOMBRE = reader.GetString(3)
                                // Asignar ID si existe en la tabla y en el modelo
                            };
                        }
                    }
                }
            }
            return u;
        }

        public int Agregar(Usuario nuevoUsuario)
        {
            int ret = 0;
            using (SqlConnection conn = _bdService.ObtenerConexion())
            {
                conn.Open();
                string query = "INSERT INTO USUARIO (USUARIO, CONTRASEÑA, NOMBRE, TIPO) VALUES (@usuario, @contraseña, @nombre, @tipo)";
                using (SqlCommand comando = new SqlCommand(query, conn))
                {
                    comando.Parameters.AddWithValue("@usuario", nuevoUsuario.USUARIO);
                    comando.Parameters.AddWithValue("@contraseña", nuevoUsuario.CONTRASEÑA); // ¡HASHEAR ANTES DE GUARDAR!
                    comando.Parameters.AddWithValue("@nombre", nuevoUsuario.NOMBRE);
                    comando.Parameters.AddWithValue("@tipo", nuevoUsuario.TIPO);
                    ret = comando.ExecuteNonQuery();
                }
            }
            return ret;
        }

        public int ModificarContraseña(string usuarioParam, string nuevaContraseñaParam)
        {
            int ret = 0;
            using (SqlConnection conn = _bdService.ObtenerConexion())
            {
                conn.Open();
                string query = "UPDATE USUARIO SET CONTRASEÑA = @nuevaContraseña WHERE USUARIO = @usuario";
                using (SqlCommand comando = new SqlCommand(query, conn))
                {
                    comando.Parameters.AddWithValue("@nuevaContraseña", nuevaContraseñaParam); // ¡HASHEAR!
                    comando.Parameters.AddWithValue("@usuario", usuarioParam);
                    ret = comando.ExecuteNonQuery();
                }
            }
            return ret;
        }

        public int Eliminar(string usuarioParam)
        {
            int ret = 0;
            using (SqlConnection conn = _bdService.ObtenerConexion())
            {
                conn.Open();
                string query = "DELETE FROM USUARIO WHERE USUARIO = @usuario";
                using (SqlCommand comando = new SqlCommand(query, conn))
                {
                    comando.Parameters.AddWithValue("@usuario", usuarioParam);
                    ret = comando.ExecuteNonQuery();
                }
            }
            return ret;
        }
    }
}
```

---

## Archivo (cs): `Services/CalculadoraService.cs`

```csharp
// Kuotasmig.Core/Services/CalculadoraService.cs
using Kuotasmig.Core.Data;
using Kuotasmig.Core.Models;
using Microsoft.Data.SqlClient;
using System;

namespace Kuotasmig.Core.Services
{
    public class CalculadoraService
    {
        private readonly BDService _bdService;

        public CalculadoraService(BDService bdService)
        {
            _bdService = bdService ?? throw new ArgumentNullException(nameof(bdService));
        }

        public CalculadoraEntry? Buscar() // Asumiendo que devuelve el último o único registro
        {
            CalculadoraEntry entry = null;
            using (SqlConnection conexion = _bdService.ObtenerConexion())
            {
                conexion.Open();
                // Ajusta esta consulta según tu lógica (ej. TOP 1 ORDER BY ID DESC si hay ID)
                string query = "SELECT TOP 1 TEXTO FROM CALCULADORA";
                using (SqlCommand comando = new SqlCommand(query, conexion))
                {
                    using (SqlDataReader reader = comando.ExecuteReader())
                    {
                        if (reader.Read())
                        {
                            entry = new CalculadoraEntry
                            {
                                TEXTO = reader.GetString(0)
                                // Asignar ID si existe
                            };
                        }
                    }
                }
            }
            return entry;
        }

        public int Agregar(CalculadoraEntry nuevaEntrada)
        {
            int ret = 0;
            using (SqlConnection conn = _bdService.ObtenerConexion())
            {
                conn.Open();
                string query = "INSERT INTO CALCULADORA (TEXTO) VALUES (@texto)";
                using (SqlCommand comando = new SqlCommand(query, conn))
                {
                    comando.Parameters.AddWithValue("@texto", nuevaEntrada.TEXTO);
                    ret = comando.ExecuteNonQuery();
                }
            }
            return ret;
        }

        // La función original de modificar actualizaba todas las filas.
        // Esto es peligroso. Asumo que quieres modificar un TEXTO específico,
        // o idealmente, un registro por ID.
        // Este ejemplo actualiza TODOS los registros, igual que el original.
        public int ModificarTodo(string nuevoTexto)
        {
            int ret = 0;
            using (SqlConnection conn = _bdService.ObtenerConexion())
            {
                conn.Open();
                string query = "UPDATE CALCULADORA SET TEXTO = @texto";
                using (SqlCommand comando = new SqlCommand(query, conn))
                {
                    comando.Parameters.AddWithValue("@texto", nuevoTexto);
                    ret = comando.ExecuteNonQuery();
                }
            }
            return ret;
        }

        // La función original de eliminar usaba "WHERE USUARIO =". Asumo que es un error
        // y que quisiste eliminar por TEXTO o un ID.
        // Este ejemplo elimina por TEXTO.
        public int EliminarPorTexto(string textoParam)
        {
            int ret = 0;
            using (SqlConnection conn = _bdService.ObtenerConexion())
            {
                conn.Open();
                string query = "DELETE FROM CALCULADORA WHERE TEXTO = @texto";
                using (SqlCommand comando = new SqlCommand(query, conn))
                {
                    comando.Parameters.AddWithValue("@texto", textoParam);
                    ret = comando.ExecuteNonQuery();
                }
            }
            return ret;
        }
    }
}
```

---

## Archivo (cs): `Program.cs`

```csharp
// Kuotasmig.Core/Program.cs
using Kuotasmig.Core.Data;
using Kuotasmig.Core.Services;
using Microsoft.AspNetCore.Http; // Necesario para AddHttpContextAccessor

var builder = WebApplication.CreateBuilder(args);

// Add services to the container.
builder.Services.AddRazorPages();

// Registrar tus servicios para Inyección de Dependencias
builder.Services.AddScoped<BDService>();
builder.Services.AddScoped<UsuarioService>();
builder.Services.AddScoped<CalculadoraService>();
builder.Services.AddScoped<CalculoAmortizacionService>();

// Necesario para acceder a HttpContext desde servicios o clases que no son PageModel/Controller directamente (como _Layout.cshtml)
builder.Services.AddHttpContextAccessor();

// Configuración para el estado de sesión
builder.Services.AddDistributedMemoryCache();
builder.Services.AddSession(options =>
{
    options.IdleTimeout = TimeSpan.FromMinutes(600);
    options.Cookie.HttpOnly = true;
    options.Cookie.IsEssential = true;
});

var app = builder.Build();

// Configure the HTTP request pipeline.
if (!app.Environment.IsDevelopment())
{
    app.UseExceptionHandler("/Error");
    app.UseHsts();
}

app.UseHttpsRedirection();
app.UseStaticFiles();

app.UseRouting();

// app.UseAuthentication(); // Descomentar cuando implementes ASP.NET Core Identity
// app.UseAuthorization();   // Descomentar cuando implementes ASP.NET Core Identity

app.UseSession(); // Habilitar el middleware de sesión ¡IMPORTANTE que esté ANTES de MapRazorPages/MapControllers!

app.MapRazorPages();

app.Run();
```

---

